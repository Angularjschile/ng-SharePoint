/*
 * ng-sharepoint
 * https://github.com/Kaldeera/ng-sharepoint/
 * Pau Codina & Pedro Castro - Kaldeera
 * Version: 0.0.1 - 2014-10-24
 * License: MIT
 */
function X2JS(a){function b(){void 0===a.escapeMode&&(a.escapeMode=!0),a.attributePrefix=void 0!==a.attributePrefix?a.attributePrefix:"_",a.arrayAccessForm=a.arrayAccessForm||"none",a.emptyNodeForm=a.emptyNodeForm||"text",void 0===a.enableToStringFunc&&(a.enableToStringFunc=!0),a.arrayAccessFormPaths=a.arrayAccessFormPaths||[],void 0===a.skipEmptyTextNodesForObj&&(a.skipEmptyTextNodesForObj=!0),void 0===a.stripWhitespaces&&(a.stripWhitespaces=!0),a.datetimeAccessFormPaths=a.datetimeAccessFormPaths||[]}function c(){function a(a){var b=String(a);return 1===b.length&&(b="0"+b),b}"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|^\n+|(\s|\n)+$/g,"")}),"function"!=typeof Date.prototype.toISOString&&(Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"})}function d(a){var b=a.localName;return null==b&&(b=a.baseName),(null==b||""==b)&&(b=a.nodeName),b}function e(a){return a.prefix}function f(a){return"string"==typeof a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"):a}function g(a){return a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/")}function h(b,c,d){switch(a.arrayAccessForm){case"property":b[c+"_asArray"]=b[c]instanceof Array?b[c]:[b[c]]}if(!(b[c]instanceof Array)&&a.arrayAccessFormPaths.length>0){for(var e=0;e<a.arrayAccessFormPaths.length;e++){var f=a.arrayAccessFormPaths[e];if("string"==typeof f){if(f==d)break}else if(f instanceof RegExp){if(f.test(d))break}else if("function"==typeof f&&f(b,c,d))break}e!=a.arrayAccessFormPaths.length&&(b[c]=[b[c]])}}function i(a){var b=a.split(/[-T:+Z]/g),c=new Date(b[0],b[1]-1,b[2]),d=b[5].split(".");if(c.setHours(b[3],b[4],d[0]),d.length>1&&c.setMilliseconds(d[1]),b[6]&&b[7]){var e=60*b[6]+Number(b[7]),f=/\d\d-\d\d:\d\d$/.test(a)?"-":"+";e=0+("-"==f?-1*e:e),c.setMinutes(c.getMinutes()-e-c.getTimezoneOffset())}else-1!==a.indexOf("Z",a.length-1)&&(c=new Date(Date.UTC(c.getFullYear(),c.getMonth(),c.getDate(),c.getHours(),c.getMinutes(),c.getSeconds(),c.getMilliseconds())));return c}function j(b,c,d){if(a.datetimeAccessFormPaths.length>0){for(var e=d.split(".#")[0],f=0;f<a.datetimeAccessFormPaths.length;f++){var g=a.datetimeAccessFormPaths[f];if("string"==typeof g){if(g==e)break}else if(g instanceof RegExp){if(g.test(e))break}else if("function"==typeof g&&g(obj,c,e))break}return f!=a.datetimeAccessFormPaths.length?i(b):b}return b}function k(b,c){if(b.nodeType==w.DOCUMENT_NODE){for(var f=new Object,i=b.childNodes,l=0;l<i.length;l++){var m=i.item(l);if(m.nodeType==w.ELEMENT_NODE){var n=d(m);f[n]=k(m,n)}}return f}if(b.nodeType==w.ELEMENT_NODE){var f=new Object;f.__cnt=0;for(var i=b.childNodes,l=0;l<i.length;l++){var m=i.item(l),n=d(m);m.nodeType!=w.COMMENT_NODE&&(f.__cnt++,null==f[n]?(f[n]=k(m,c+"."+n),h(f,n,c+"."+n)):(null!=f[n]&&(f[n]instanceof Array||(f[n]=[f[n]],h(f,n,c+"."+n))),f[n][f[n].length]=k(m,c+"."+n)))}for(var o=0;o<b.attributes.length;o++){var p=b.attributes.item(o);f.__cnt++,f[a.attributePrefix+p.name]=p.value}var q=e(b);return null!=q&&""!=q&&(f.__cnt++,f.__prefix=q),null!=f["#text"]&&(f.__text=f["#text"],f.__text instanceof Array&&(f.__text=f.__text.join("\n")),a.escapeMode&&(f.__text=g(f.__text)),a.stripWhitespaces&&(f.__text=f.__text.trim()),delete f["#text"],"property"==a.arrayAccessForm&&delete f["#text_asArray"],f.__text=j(f.__text,n,c+"."+n)),null!=f["#cdata-section"]&&(f.__cdata=f["#cdata-section"],delete f["#cdata-section"],"property"==a.arrayAccessForm&&delete f["#cdata-section_asArray"]),1==f.__cnt&&null!=f.__text?f=f.__text:0==f.__cnt&&"text"==a.emptyNodeForm?f="":f.__cnt>1&&null!=f.__text&&a.skipEmptyTextNodesForObj&&(a.stripWhitespaces&&""==f.__text||""==f.__text.trim())&&delete f.__text,delete f.__cnt,!a.enableToStringFunc||null==f.__text&&null==f.__cdata||(f.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),f}return b.nodeType==w.TEXT_NODE||b.nodeType==w.CDATA_SECTION_NODE?b.nodeValue:void 0}function l(b,c,d,e){var g="<"+(null!=b&&null!=b.__prefix?b.__prefix+":":"")+c;if(null!=d)for(var h=0;h<d.length;h++){var i=d[h],j=b[i];a.escapeMode&&(j=f(j)),g+=" "+i.substr(a.attributePrefix.length)+"='"+j+"'"}return g+=e?"/>":">"}function m(a,b){return"</"+(null!=a.__prefix?a.__prefix+":":"")+b+">"}function n(a,b){return-1!==a.indexOf(b,a.length-b.length)}function o(b,c){return"property"==a.arrayAccessForm&&n(c.toString(),"_asArray")||0==c.toString().indexOf(a.attributePrefix)||0==c.toString().indexOf("__")||b[c]instanceof Function?!0:!1}function p(a){var b=0;if(a instanceof Object)for(var c in a)o(a,c)||b++;return b}function q(b){var c=[];if(b instanceof Object)for(var d in b)-1==d.toString().indexOf("__")&&0==d.toString().indexOf(a.attributePrefix)&&c.push(d);return c}function r(b){var c="";return null!=b.__cdata&&(c+="<![CDATA["+b.__cdata+"]]>"),null!=b.__text&&(c+=a.escapeMode?f(b.__text):b.__text),c}function s(b){var c="";return b instanceof Object?c+=r(b):null!=b&&(c+=a.escapeMode?f(b):b),c}function t(a,b,c){var d="";if(0==a.length)d+=l(a,b,c,!0);else for(var e=0;e<a.length;e++)d+=l(a[e],b,q(a[e]),!1),d+=u(a[e]),d+=m(a[e],b);return d}function u(a){var b="",c=p(a);if(c>0)for(var d in a)if(!o(a,d)){var e=a[d],f=q(e);if(null==e||void 0==e)b+=l(e,d,f,!0);else if(e instanceof Object)if(e instanceof Array)b+=t(e,d,f);else if(e instanceof Date)b+=l(e,d,f,!1),b+=e.toISOString(),b+=m(e,d);else{var g=p(e);g>0||null!=e.__text||null!=e.__cdata?(b+=l(e,d,f,!1),b+=u(e),b+=m(e,d)):b+=l(e,d,f,!0)}else b+=l(e,d,f,!1),b+=s(e),b+=m(e,d)}return b+=s(a)}var v="1.1.5";a=a||{},b(),c();var w={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};this.parseXmlString=function(a){var b=window.ActiveXObject||"ActiveXObject"in window;if(void 0===a)return null;var c;if(window.DOMParser){var d=new window.DOMParser,e=null;if(!b)try{e=d.parseFromString("INVALID","text/xml").childNodes[0].namespaceURI}catch(f){e=null}try{c=d.parseFromString(a,"text/xml"),null!=e&&c.getElementsByTagNameNS(e,"parsererror").length>0&&(c=null)}catch(f){c=null}}else 0==a.indexOf("<?")&&(a=a.substr(a.indexOf("?>")+2)),c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a);return c},this.asArray=function(a){return a instanceof Array?a:[a]},this.toXmlDateTime=function(a){return a instanceof Date?a.toISOString():"number"==typeof a?new Date(a).toISOString():null},this.asDateTime=function(a){return"string"==typeof a?i(a):a},this.xml2json=function(a){return k(a)},this.xml_str2json=function(a){var b=this.parseXmlString(a);return null!=b?this.xml2json(b):null},this.json2xml_str=function(a){return u(a)},this.json2xml=function(a){var b=this.json2xml_str(a);return this.parseXmlString(b)},this.getVersion=function(){return v}}angular.module("CamlHelper",[]).value("CamlOperatorEnumerator",{CamlQueryOperator:{BeginsWith:"BeginsWith",Contains:"Contains",DateRangesOverlap:"DateRangesOverlap",Eq:"Eq",Geq:"Geq",Gt:"Gt",In:"In",Includes:"Includes",IsNotNull:"IsNotNull",IsNull:"IsNull",Leq:"Leq",Lt:"Lt",Neq:"Neq",NotIncludes:"NotIncludes"}}).provider("CamlQueryHelperProvider",function(){"use strict";var a=function(a){this.CamlQueryHelper=function(){return{Query:"",OrderByFields:"",GroupByFiels:"",Wrap:function(a,b){return"<"+a+">"+b+"</"+a+">"},Join:function(b,c,d,e,f){var g;g=f?"<FieldRef Name='"+c+"' LookupId='True' />":"<FieldRef Name='"+c+"' />";var h=b,i="";switch(b){case a.CamlQueryOperator.In:e=e.replace("[",""),e=e.replace("]","");var j=e.split(","),k="<Values>";j.forEach(function(a){var b=a.trim(),c="";c=isNaN(parseInt(b))?"<Value Type='Text'>"+b+"</Value>":"<Value Type='Integer'>"+b+"</Value>",k+=c}),k+="</Values>",i=g+k;break;case a.CamlQueryOperator.IsNull:case a.CamlQueryOperator.IsNotNull:i=g;break;default:var l="<Value Type='"+d+"'>"+e+"</Value>";i=g+l}return this.Wrap(h,i)},OrJoin:function(a,b,c,d,e){var f=this.Join(a,b,c,d,e);this.Query?(this.Query+=f,this.Query=this.Wrap("Or",this.Query)):this.Query+=f},AndJoin:function(a,b,c,d,e){var f=this.Join(a,b,c,d,e);this.Query?(this.Query+=f,this.Query=this.Wrap("And",this.Query)):this.Query+=f},AddOrderByField:function(a,b){this.OrderByFields+="<FieldRef Name='"+a+"' Ascending='"+b+"' />"},AddGroupByField:function(a){this.GroupByFiels+="<FieldRef Name='"+a+"' />"},ToString:function(){var a="",b="",c="";return this.Query&&(a=this.Wrap("Where",this.Query)),this.OrderByFields&&(b=this.Wrap("OrderBy",this.OrderByFields)),this.GroupByFiels&&(c=this.Wrap("GroupBy",this.GroupByFiels)),"<Query>"+a+c+b+"</Query>"}}}};this.$get=function(b){return new a(b)}}).provider("ODataSentencePartProvider",function(){var a=function(a){this.ODataSentencePart=function(b,c,d){return{Expression:b,Join:c,Fields:d,ProcessOk:!1,Operator:"",Left:"",Right:"",Field:"",Value:"",process:function(){if(this.testOperator(" eq ")&&this.processOperator(" eq ",a.CamlQueryOperator.Eq),this.testOperator(" ne ")&&this.processOperator(" ne ",a.CamlQueryOperator.Neq),this.testOperator(" gt ")&&this.processOperator(" gt ",a.CamlQueryOperator.Gt),this.testOperator(" ge ")&&this.processOperator(" ge ",a.CamlQueryOperator.Geq),this.testOperator(" lt ")&&this.processOperator(" lt ",a.CamlQueryOperator.Lt),this.testOperator(" le ")&&this.processOperator(" le ",a.CamlQueryOperator.Leq),this.testOperator(" lt ")&&this.processOperator(" lt ",a.CamlQueryOperator.Lt),this.testOperator(" in ")&&this.processOperator(" in ",a.CamlQueryOperator.In),this.testOperator(" contains ")&&this.processOperator(" contains ",a.CamlQueryOperator.Contains),this.testOperator(" beginswith ")&&this.processOperator(" beginswith ",a.CamlQueryOperator.Contains),this.testOperator(" isnull")&&this.processOperator(" isnull",a.CamlQueryOperator.IsNull),this.testOperator(" isnotnull")&&this.processOperator(" isnotnull",a.CamlQueryOperator.IsNotNull),!this.ProcessOk)throw"Invalid sentence: "+this.Expression;if(!this.isValidFieldInternalName(this.Fields,this.Left,this.Right)&&!this.isValidFieldInternalName(this.Fields,this.Right,this.Left))throw"Invalid sentence, any valid field vas specified ("+this.Expression+")"},isValidFieldInternalName:function(a,b,c){try{return this.Field=this.Fields.Fields[b],this.Value=c,!0}catch(d){return!1}},processOperator:function(a,b){this.Operator=b;var c=this.Expression.indexOf(a);this.Left=this.Expression.substring(0,c),this.Right=this.Expression.substring(c+a.length),this.ProcessOk=!0},testOperator:function(a){return-1==this.Expression.toLowerCase().indexOf(a)?!1:!0}}}};this.$get=function(b){return new a(b)}}).provider("ODataParserProvider",function(){var a=function(a,b){this.ODataParser=function(c){if(void 0===c)throw"fieldsSchema not specified";return{Filter:"",Sort:"",Select:"",Top:"",Paging:!1,Skip:"",Sentences:[],FieldsSchema:c,parseExpression:function(a){this.Filter="",this.Sort="",this.Select="",this.Top="",this.Skip="",this.GroupBy="",this.Paging=!1,void 0!==a.filter&&(this.Filter=a.filter),void 0!==a.orderBy&&(this.Sort=a.orderBy),void 0!==a.select&&(this.Select=a.select),void 0!==a.groupBy&&(this.GroupBy=a.groupBy),void 0!==a.top&&(this.Top=a.top),void 0!==a.paging&&(this.Paging=a.paging),void 0!==a.skip&&(this.Skip=a.skip);for(var b=this.Filter;b.length>0;){var c=this.getNextSentence(b),d=c.dataSentencePart;d.process(),b=c.expression,this.Sentences.push(d)}},getCAMLQuery:function(){var b="",c=a.CamlQueryHelper();this.Sentences.reverse();for(var d=0;d<this.Sentences.length;d++){var e=!1,f=this.Sentences[d];if("Lookup"==f.Field.get_typeAsString()||"User"==f.Field.get_typeAsString()||"LookupMulti"==f.Field.get_typeAsString()||"UserMulti"==f.Field.get_typeAsString()){var g=f.Value;g=g.replace("[",""),g=g.replace("]","");var h=g.split(",");e=isNaN(parseInt(h[0]))?!1:!0}switch(f.Join){case"or":c.OrJoin(f.Operator,f.Field.get_internalName(),f.Field.get_typeAsString(),f.Value,e);break;default:c.AndJoin(f.Operator,f.Field.get_internalName(),f.Field.get_typeAsString(),f.Value,e)}}if(this.Sort.length>0)for(var i=this.Sort.split(","),j=0;j<i.length;j++)if(""!==i[j]){var k=i[j],l=k.trim().split(" ");try{var m=this.FieldsSchema.Fields[l[0]],n=!0;l.length>1&&"desc"==l[1].trim().toLowerCase()&&(n=!1),c.AddOrderByField(m.get_internalName(),n)}catch(o){throw o}}if(void 0!==this.GroupBy&&""!==this.GroupBy)for(var p=this.GroupBy.split(","),q=0;q<p.length;q++){var r=p[q].trim();r.length>0&&c.AddGroupByField(r)}b=c.ToString();var s="";void 0!==this.Top&&""!==this.Top&&(s+="<RowLimit Paged='TRUE'>"+this.Top+"</RowLimit>");var t="";if(this.Select.length>0){t="<ViewFields>";for(var u=this.Select.split(","),v=0;v<u.length;v++){var w=u[v].trim();w.length>0&&(t+="<FieldRef Name='"+w+"' />")}t+="</ViewFields>"}return"<View>"+t+b+s+"</View>"},getNextSentence:function(a){var c=-1,d=" and ";c=a.toLowerCase().indexOf(d),-1==c&&(d=" or ",c=a.toLowerCase().indexOf(d)),-1==c&&(c=a.length,d="");var e=a.substring(0,c);a=a.substring(c+d.length);var f=b.ODataSentencePart(e,d.trim(),this.FieldsSchema),g={expression:a,dataSentencePart:f};return g}}}};this.$get=function(b,c,d){return new a(b,c,d)}}),function(a,b){function c(){var a=p.elements;return"string"==typeof a?a.split(" "):a}function d(a){var b=o[a[m]];return b||(b={},n++,a[m]=n,o[n]=b),b}function e(a,c,e){return c||(c=b),i?c.createElement(a):(e||(e=d(c)),c=e.cache[a]?e.cache[a].cloneNode():l.test(a)?(e.cache[a]=e.createElem(a)).cloneNode():e.createElem(a),c.canHaveChildren&&!k.test(a)?e.frag.appendChild(c):c)}function f(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return p.shivMethods?e(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+c().join().replace(/[\w\-]+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(p,b.frag)}function g(a){a||(a=b);var c=d(a);if(p.shivCSS&&!h&&!c.hasCSS){var e,g=a;e=g.createElement("p"),g=g.getElementsByTagName("head")[0]||g.documentElement,e.innerHTML="x<style>article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}</style>",e=g.insertBefore(e.lastChild,g.firstChild),c.hasCSS=!!e}return i||f(a,c),a}var h,i,j=a.html5||{},k=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,l=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,m="_html5shiv",n=0,o={};!function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",h="hidden"in a;var c;if(!(c=1==a.childNodes.length)){b.createElement("a");var d=b.createDocumentFragment();c="undefined"==typeof d.cloneNode||"undefined"==typeof d.createDocumentFragment||"undefined"==typeof d.createElement}i=c}catch(e){i=h=!0}}();var p={elements:j.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==j.shivCSS,supportsUnknownElements:i,shivMethods:!1!==j.shivMethods,type:"default",shivDocument:g,createElement:e,createDocumentFragment:function(a,e){if(a||(a=b),i)return a.createDocumentFragment();for(var e=e||d(a),f=e.frag.cloneNode(),g=0,h=c(),j=h.length;j>g;g++)f.createElement(h[g]);return f}};a.html5=p,g(b)}(this,document),function(a){function b(b){return a.less[b.split("/")[1]]}function c(){"development"===p.env?(p.optimization=0,p.watchTimer=setInterval(function(){p.watchMode&&e(function(a,b,c,d,e){b&&j(b.toCSS(),d,e.lastModified)})},p.poll)):p.optimization=3}function d(){for(var a=document.getElementsByTagName("style"),b=0;b<a.length;b++)a[b].type.match(x)&&new p.Parser({filename:document.location.href.replace(/#.*$/,""),dumpLineNumbers:p.dumpLineNumbers}).parse(a[b].innerHTML||"",function(c,d){var e=d.toCSS(),f=a[b];f.type="text/css",f.styleSheet?f.styleSheet.cssText=e:f.innerHTML=e})}function e(a,b){for(var c=0;c<p.sheets.length;c++)h(p.sheets[c],a,b,p.sheets.length-(c+1))}function f(a,b){var c,d,e,f,h=g(a),i=g(b),j="";if(h.hostPart!==i.hostPart)return"";for(d=Math.max(i.directories.length,h.directories.length),c=0;d>c&&i.directories[c]===h.directories[c];c++);for(f=i.directories.slice(c),e=h.directories.slice(c),c=0;c<f.length-1;c++)j+="../";for(c=0;c<e.length-1;c++)j+=e[c]+"/";return j}function g(a,b){var c,d,e=/^((?:[a-z-]+:)?\/\/(?:[^\/\?#]*\/)|([\/\\]))?((?:[^\/\\\?#]*[\/\\])*)([^\/\\\?#]*)([#\?].*)?$/,f=a.match(e),g={},h=[];if(!f)throw new Error("Could not parse sheet href - '"+a+"'");if(!f[1]||f[2]){if(d=b.match(e),!d)throw new Error("Could not parse page url - '"+b+"'");f[1]=d[1],f[2]||(f[3]=d[3]+f[3])}if(f[3])for(h=f[3].replace("\\","/").split("/"),c=0;c<h.length;c++)".."===h[c]&&c>0&&(h.splice(c-1,2),c-=2);return g.hostPart=f[1],g.directories=h,g.path=f[1]+h.join("/"),g.fileUrl=g.path+(f[4]||""),g.url=g.fileUrl+(f[5]||""),g}function h(b,c,d,e){var h,l=b.contents||{},n=b.files||{},q=g(b.href,a.location.href),r=q.url,s=u&&u.getItem(r),t=u&&u.getItem(r+":timestamp"),v={css:s,timestamp:t};h=p.relativeUrls?p.rootpath?b.entryPath?g(p.rootpath+f(q.path,b.entryPath)).path:p.rootpath:q.path:p.rootpath?p.rootpath:b.entryPath?b.entryPath:q.path,k(r,b.type,function(a,f){if(z+=a.replace(/@import .+?;/gi,""),!d&&v&&f&&new Date(f).valueOf()===new Date(v.timestamp).valueOf())j(v.css,b),c(null,null,a,b,{local:!0,remaining:e},r);else try{l[r]=a,new p.Parser({optimization:p.optimization,paths:[q.path],entryPath:b.entryPath||q.path,mime:b.type,filename:r,rootpath:h,relativeUrls:b.relativeUrls,contents:l,files:n,dumpLineNumbers:p.dumpLineNumbers}).parse(a,function(d,g){if(d)return o(d,r);try{c(d,g,a,b,{local:!1,lastModified:f,remaining:e},r),m(document.getElementById("less-error-message:"+i(r)))}catch(d){o(d,r)}})}catch(g){o(g,r)}},function(a,b){throw new Error("Couldn't load "+b+" ("+a+")")})}function i(a){return a.replace(/^[a-z]+:\/\/?[^\/]+/,"").replace(/^\//,"").replace(/\.[a-zA-Z]+$/,"").replace(/[^\.\w-]+/g,"-").replace(/\./g,":")}function j(a,b,c){var d,e=b.href||"",f="less:"+(b.title||i(e));if(null===(d=document.getElementById(f))){d=document.createElement("style"),d.type="text/css",b.media&&(d.media=b.media),d.id=f;var g=b&&b.nextSibling||null;(g||document.getElementsByTagName("head")[0]).parentNode.insertBefore(d,g)}if(d.styleSheet)try{d.styleSheet.cssText=a}catch(h){throw new Error("Couldn't reassign styleSheet.cssText.")}else(function(a){d.childNodes.length>0?d.firstChild.nodeValue!==a.nodeValue&&d.replaceChild(a,d.firstChild):d.appendChild(a)})(document.createTextNode(a));if(c&&u){n("saving "+e+" to cache.");try{u.setItem(e,a),u.setItem(e+":timestamp",c)}catch(h){n("failed to save")}}}function k(a,b,c,d){function e(b,c,d){b.status>=200&&b.status<300?c(b.responseText,b.getResponseHeader("Last-Modified")):"function"==typeof d&&d(b.status,a)}var f=l(),g=r?p.fileAsync:p.async;"function"==typeof f.overrideMimeType&&f.overrideMimeType("text/css"),f.open("GET",a,g),f.setRequestHeader("Accept",b||"text/x-less, text/css; q=0.9, */*; q=0.5"),f.send(null),r&&!p.fileAsync?0===f.status||f.status>=200&&f.status<300?c(f.responseText):d(f.status,a):g?f.onreadystatechange=function(){4==f.readyState&&e(f,c,d)}:e(f,c,d)}function l(){if(a.XMLHttpRequest)return new XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(b){return n("browser doesn't support AJAX."),null}}function m(a){return a&&a.parentNode.removeChild(a)}function n(a){"development"==p.env&&"undefined"!=typeof console&&console.log("less: "+a)}function o(a,b){var c,d,e="less-error-message:"+i(b),f='<li><label>{line}</label><pre class="{class}">{content}</pre></li>',g=document.createElement("div"),h=[],k=a.filename||b,l=k.match(/([^\/]+(\?.*)?)$/)[1];g.id=e,g.className="less-error-message",d="<h3>"+(a.message||"There is an error in your .less file")+'</h3><p>in <a href="'+k+'">'+l+"</a> ";var m=function(a,b,c){a.extract[b]&&h.push(f.replace(/\{line\}/,parseInt(a.line)+(b-1)).replace(/\{class\}/,c).replace(/\{content\}/,a.extract[b]))};a.stack?d+="<br/>"+a.stack.split("\n").slice(1).join("<br/>"):a.extract&&(m(a,0,""),m(a,1,"line"),m(a,2,""),d+="on line "+a.line+", column "+(a.column+1)+":</p><ul>"+h.join("")+"</ul>"),g.innerHTML=d,j([".less-error-message ul, .less-error-message li {","list-style-type: none;","margin-right: 15px;","padding: 4px 0;","margin: 0;","}",".less-error-message label {","font-size: 12px;","margin-right: 15px;","padding: 4px 0;","color: #cc7777;","}",".less-error-message pre {","color: #dd6666;","padding: 4px 0;","margin: 0;","display: inline-block;","}",".less-error-message pre.line {","color: #ff0000;","}",".less-error-message h3 {","font-size: 20px;","font-weight: bold;","padding: 15px 0 5px 0;","margin: 0;","}",".less-error-message a {","color: #10a","}",".less-error-message .error {","color: red;","font-weight: bold;","padding-bottom: 2px;","border-bottom: 1px dashed red;","}"].join("\n"),{title:"error-message"}),g.style.cssText=["font-family: Arial, sans-serif","border: 1px solid #e00","background-color: #eee","border-radius: 5px","-webkit-border-radius: 5px","-moz-border-radius: 5px","color: #e00","padding: 15px","margin-bottom: 15px"].join(";"),"development"==p.env&&(c=setInterval(function(){document.body&&(document.getElementById(e)?document.body.replaceChild(g,document.getElementById(e)):document.body.insertBefore(g,document.body.firstChild),clearInterval(c))},10))}Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)||a instanceof Array}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){for(var c=this.length>>>0,d=0;c>d;d++)d in this&&a.call(b,this[d],d,this)}),Array.prototype.map||(Array.prototype.map=function(a){for(var b=this.length>>>0,c=new Array(b),d=arguments[1],e=0;b>e;e++)e in this&&(c[e]=a.call(d,this[e],e,this));return c}),Array.prototype.filter||(Array.prototype.filter=function(a){for(var b=[],c=arguments[1],d=0;d<this.length;d++)a.call(c,this[d])&&b.push(this[d]);return b}),Array.prototype.reduce||(Array.prototype.reduce=function(a){var b=this.length>>>0,c=0;if(0===b&&1===arguments.length)throw new TypeError;if(arguments.length>=2)var d=arguments[1];else for(;;){if(c in this){d=this[c++];break}if(++c>=b)throw new TypeError}for(;b>c;c++)c in this&&(d=a.call(null,d,this[c],c,this));return d}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length,c=arguments[1]||0;if(!b)return-1;if(c>=b)return-1;for(0>c&&(c+=b);b>c;c++)if(Object.prototype.hasOwnProperty.call(this,c)&&a===this[c])return c;return-1}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}),String.prototype.trim||(String.prototype.trim=function(){return String(this).replace(/^\s\s*/,"").replace(/\s\s*$/,"")});var p,q;"object"==typeof environment&&"[object Environment]"==={}.toString.call(environment)?(p="undefined"==typeof a?{}:a.less={},q=p.tree={},p.mode="rhino"):"undefined"==typeof a?(p=exports,q=b("./tree"),p.mode="node"):("undefined"==typeof a.less&&(a.less={}),p=a.less,q=a.less.tree={},p.mode="browser"),p.Parser=function(a){function c(){v=y[u],w=t,z=t}function d(){y[u]=v,t=w,z=t}function e(){t>z&&(y[u]=y[u].slice(t-z),z=t)}function f(a){var b=a.charCodeAt(0);return 32===b||10===b||9===b}function g(a){var b,c;if(a instanceof Function)return a.call(A.parsers);if("string"==typeof a)b=s.charAt(t)===a?a:null,c=1,e();else{if(e(),!(b=a.exec(y[u])))return null;c=b[0].length}return b?(h(c),"string"==typeof b?b:1===b.length?b[0]:b):void 0}function h(a){for(var b=t,c=u,d=t+y[u].length,e=t+=a;d>t&&f(s.charAt(t));)t++;return y[u]=y[u].slice(a+(t-e)),z=t,0===y[u].length&&u<y.length-1&&u++,b!==t||c!==u}function i(a,b){var c=g(a);return c?c:void j(b||("string"==typeof a?"expected '"+a+"' got '"+s.charAt(t)+"'":"unexpected token"))}function j(a,b){var c=new Error(a);throw c.index=t,c.type=b||"Syntax",c}function k(a){return"string"==typeof a?s.charAt(t)===a:a.test(y[u])?!0:!1}function l(a,b){return a.filename&&b.filename&&a.filename!==b.filename?A.imports.contents[a.filename]:s}function m(a,b){for(var c=a,d=-1;c>=0&&"\n"!==b.charAt(c);c--)d++;return{line:"number"==typeof a?(b.slice(0,a).match(/\n/g)||"").length:null,column:d}}function n(a){return"browser"===p.mode||"rhino"===p.mode?a.filename:b("path").resolve(a.filename)}function o(a,b,c){return{lineNumber:m(a,b).line+1,fileName:n(c)}}function r(a,b){var c=l(a,b),d=m(a.index,c),e=d.line,f=d.column,g=c.split("\n");this.type=a.type||"Syntax",this.message=a.message,this.filename=a.filename||b.filename,this.index=a.index,this.line="number"==typeof e?e+1:null,this.callLine=a.call&&m(a.call,c).line+1,this.callExtract=g[m(a.call,c).line],this.stack=a.stack,this.column=f,this.extract=[g[e-1],g[e],g[e+1]]}var s,t,u,v,w,x,y,z,A,a=a||{};a.contents||(a.contents={}),a.rootpath=a.rootpath||"",a.files||(a.files={});var B=function(){},C=this.imports={paths:a.paths||[],queue:[],files:a.files,contents:a.contents,mime:a.mime,error:null,push:function(b,c){var d=this;this.queue.push(b),p.Parser.importer(b,this.paths,function(a,e,f){d.queue.splice(d.queue.indexOf(b),1);var g=f in d.files;d.files[f]=e,a&&!d.error&&(d.error=a),c(a,e,g),0===d.queue.length&&B(d.error)},a)}};return this.env=a=a||{},this.optimization="optimization"in this.env?this.env.optimization:1,this.env.filename=this.env.filename||null,A={imports:C,parse:function(c,d){var e,f,h,i=null;if(t=u=z=x=0,s=c.replace(/\r\n/g,"\n"),s=s.replace(/^\uFEFF/,""),y=function(b){for(var c,d,e,f,g=0,h=/(?:@\{[\w-]+\}|[^"'`\{\}\/\(\)\\])+/g,j=/\/\*(?:[^*]|\*+[^\/*])*\*+\/|\/\/.*/g,k=/"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'|`((?:[^`]|\\.)*)`/g,l=0,m=b[0],n=0;n<s.length;)if(h.lastIndex=n,(c=h.exec(s))&&c.index===n&&(n+=c[0].length,m.push(c[0])),e=s.charAt(n),j.lastIndex=k.lastIndex=n,(c=k.exec(s))&&c.index===n)n+=c[0].length,m.push(c[0]);else if(d||"/"!==e||(f=s.charAt(n+1),"/"!==f&&"*"!==f||!(c=j.exec(s))||c.index!==n)){switch(e){case"{":if(!d){l++,m.push(e);break}case"}":if(!d){l--,m.push(e),b[++g]=m=[];break}case"(":if(!d){d=!0,m.push(e);break}case")":if(d){d=!1,m.push(e);break}default:m.push(e)}n++}else n+=c[0].length,m.push(c[0]);return 0!=l&&(i=new r({index:n-1,type:"Parse",message:l>0?"missing closing `}`":"missing opening `{`",filename:a.filename},a)),b.map(function(a){return a.join("")})}([[]]),i)return d(i,a);try{e=new q.Ruleset([],g(this.parsers.primary)),e.root=!0}catch(j){return d(new r(j,a))}if(e.toCSS=function(c){return function(d,e){var f,g=[];d=d||{},"object"==typeof e&&!Array.isArray(e)&&(e=Object.keys(e).map(function(a){var b=e[a];return b instanceof q.Value||(b instanceof q.Expression||(b=new q.Expression([b])),b=new q.Value([b])),new q.Rule("@"+a,b,!1,0)}),g=[new q.Ruleset(null,e)]);try{var h=c.call(this,{frames:g}).toCSS([],{compress:d.compress||!1,dumpLineNumbers:a.dumpLineNumbers})}catch(i){throw new r(i,a)}if(f=A.imports.error)throw f instanceof r?f:new r(f,a);return d.yuicompress&&"node"===p.mode?b("ycssmin").cssmin(h):d.compress?h.replace(/(\s)+/g,"$1"):h}}(e.eval),t<s.length-1){t=x,h=s.split("\n"),f=(s.slice(0,t).match(/\n/g)||"").length+1;for(var k=t,l=-1;k>=0&&"\n"!==s.charAt(k);k--)l++;i={type:"Parse",message:"Syntax Error on line "+f,index:t,filename:a.filename,line:f,column:l,extract:[h[f-2],h[f-1],h[f]]}}this.imports.queue.length>0?B=function(a){a=i||a,a?d(a):d(null,e)}:d(i,e)},parsers:{primary:function(){for(var a,b=[];(a=g(this.mixin.definition)||g(this.rule)||g(this.ruleset)||g(this.mixin.call)||g(this.comment)||g(this.directive))||g(/^[\s\n]+/)||g(/^;+/);)a&&b.push(a);return b},comment:function(){var a;if("/"===s.charAt(t))return"/"===s.charAt(t+1)?new q.Comment(g(/^\/\/.*/),!0):(a=g(/^\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/))?new q.Comment(a):void 0},entities:{quoted:function(){var a,b,c=t;return"~"===s.charAt(c)&&(c++,b=!0),'"'===s.charAt(c)||"'"===s.charAt(c)?(b&&g("~"),(a=g(/^"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/))?new q.Quoted(a[0],a[1]||a[2],b):void 0):void 0},keyword:function(){var a;return(a=g(/^[_A-Za-z-][_A-Za-z0-9-]*/))?q.colors.hasOwnProperty(a)?new q.Color(q.colors[a].slice(1)):new q.Keyword(a):void 0},call:function(){var b,c,d,e,f=t;if(b=/^([\w-]+|%|progid:[\w\.]+)\(/.exec(y[u])){if(b=b[1],c=b.toLowerCase(),"url"===c)return null;if(t+=b.length,"alpha"===c&&(e=g(this.alpha),"undefined"!=typeof e))return e;if(g("("),d=g(this.entities.arguments),g(")"))return b?new q.Call(b,d,f,a.filename):void 0}},arguments:function(){for(var a,b=[];(a=g(this.entities.assignment)||g(this.expression))&&(b.push(a),g(",")););return b},literal:function(){return g(this.entities.ratio)||g(this.entities.dimension)||g(this.entities.color)||g(this.entities.quoted)||g(this.entities.unicodeDescriptor)},assignment:function(){var a,b;return(a=g(/^\w+(?=\s?=)/i))&&g("=")&&(b=g(this.entity))?new q.Assignment(a,b):void 0},url:function(){var b;if("u"===s.charAt(t)&&g(/^url\(/))return b=g(this.entities.quoted)||g(this.entities.variable)||g(/^(?:(?:\\[\(\)'"])|[^\(\)'"])+/)||"",i(")"),new q.URL(null!=b.value||b instanceof q.Variable?b:new q.Anonymous(b),a.rootpath)},variable:function(){var b,c=t;return"@"===s.charAt(t)&&(b=g(/^@@?[\w-]+/))?new q.Variable(b,c,a.filename):void 0},variableCurly:function(){var b,c=t;return"@"===s.charAt(t)&&(b=g(/^@\{([\w-]+)\}/))?new q.Variable("@"+b[1],c,a.filename):void 0},color:function(){var a;return"#"===s.charAt(t)&&(a=g(/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})/))?new q.Color(a[1]):void 0},dimension:function(){var a,b=s.charCodeAt(t);if(!(b>57||43>b||47===b||44==b))return(a=g(/^([+-]?\d*\.?\d+)(px|%|em|pc|ex|in|deg|s|ms|pt|cm|mm|rad|grad|turn|dpi|dpcm|dppx|rem|vw|vh|vmin|vm|ch)?/))?new q.Dimension(a[1],a[2]):void 0},ratio:function(){var a,b=s.charCodeAt(t);if(!(b>57||48>b))return(a=g(/^(\d+\/\d+)/))?new q.Ratio(a[1]):void 0},unicodeDescriptor:function(){var a;return(a=g(/^U\+[0-9a-fA-F?]+(\-[0-9a-fA-F?]+)?/))?new q.UnicodeDescriptor(a[0]):void 0},javascript:function(){var a,b,c=t;return"~"===s.charAt(c)&&(c++,b=!0),"`"===s.charAt(c)?(b&&g("~"),(a=g(/^`([^`]*)`/))?new q.JavaScript(a[1],t,b):void 0):void 0}},variable:function(){var a;return"@"===s.charAt(t)&&(a=g(/^(@[\w-]+)\s*:/))?a[1]:void 0},shorthand:function(){var a,b;if(k(/^[@\w.%-]+\/[@\w.-]+/))return c(),(a=g(this.entity))&&g("/")&&(b=g(this.entity))?new q.Shorthand(a,b):void d()},mixin:{call:function(){var b,e,f,h,l,m,n,o,p,r,u=[],v=[],w=[],x=t,y=s.charAt(t),z=!1;if("."===y||"#"===y){for(c();b=g(/^[#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/);)u.push(new q.Element(e,b,t)),e=g(">");if(g("(")){for(m=[];h=g(this.expression);){if(l=null,r=h,1==h.value.length){var A=h.value[0];A instanceof q.Variable&&g(":")&&(m.length>0&&(n&&j("Cannot mix ; and , as delimiter types"),o=!0),r=i(this.expression),l=p=A.name)}m.push(r),w.push({name:l,value:r}),g(",")||(g(";")||n)&&(o&&j("Cannot mix ; and , as delimiter types"),n=!0,m.length>1&&(r=new q.Value(m)),v.push({name:p,value:r}),p=null,m=[],o=!1)}i(")")}return f=n?v:w,g(this.important)&&(z=!0),u.length>0&&(g(";")||k("}"))?new q.mixin.Call(u,f,x,a.filename,z):void d()}},definition:function(){var a,b,e,f,h,j,l=[],m=!1;if(!("."!==s.charAt(t)&&"#"!==s.charAt(t)||k(/^[^{]*\}/))&&(c(),b=g(/^([#.](?:[\w-]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+)\s*\(/))){a=b[1];do{if(g(this.comment),"."===s.charAt(t)&&g(/^\.{3}/)){m=!0,l.push({variadic:!0});break}if(!(f=g(this.entities.variable)||g(this.entities.literal)||g(this.entities.keyword)))break;if(f instanceof q.Variable)if(g(":"))h=i(this.expression,"expected expression"),l.push({name:f.name,value:h});else{if(g(/^\.{3}/)){l.push({name:f.name,variadic:!0}),m=!0;break}l.push({name:f.name})}else l.push({value:f})}while(g(",")||g(";"));if(g(")")||(x=t,d()),g(this.comment),g(/^when/)&&(j=i(this.conditions,"expected condition")),e=g(this.block),e)return new q.mixin.Definition(a,l,e,j,m);
d()}}},entity:function(){return g(this.entities.literal)||g(this.entities.variable)||g(this.entities.url)||g(this.entities.call)||g(this.entities.keyword)||g(this.entities.javascript)||g(this.comment)},end:function(){return g(";")||k("}")},alpha:function(){var a;if(g(/^\(opacity=/i))return(a=g(/^\d+/)||g(this.entities.variable))?(i(")"),new q.Alpha(a)):void 0},element:function(){var a,b,c;return b=g(this.combinator),a=g(/^(?:\d+\.\d+|\d+)%/)||g(/^(?:[.#]?|:*)(?:[\w-]|[^\x00-\x9f]|\\(?:[A-Fa-f0-9]{1,6} ?|[^A-Fa-f0-9]))+/)||g("*")||g("&")||g(this.attribute)||g(/^\([^()@]+\)/)||g(/^[\.#](?=@)/)||g(this.entities.variableCurly),a||g("(")&&(c=g(this.entities.variableCurly)||g(this.entities.variable)||g(this.selector))&&g(")")&&(a=new q.Paren(c)),a?new q.Element(b,a,t):void 0},combinator:function(){var a=s.charAt(t);if(">"===a||"+"===a||"~"===a||"|"===a){for(t++;s.charAt(t).match(/\s/);)t++;return new q.Combinator(a)}return new q.Combinator(s.charAt(t-1).match(/\s/)?" ":null)},selector:function(){var a,b,c,d=[];if(g("("))return a=g(this.entity),g(")")?new q.Selector([new q.Element("",a,t)]):null;for(;(b=g(this.element))&&(c=s.charAt(t),d.push(b),"{"!==c&&"}"!==c&&";"!==c&&","!==c&&")"!==c););return d.length>0?new q.Selector(d):void 0},attribute:function(){var a,b,c,d="";if(g("[")&&((a=g(/^(?:[_A-Za-z0-9-]|\\.)+/)||g(this.entities.quoted))&&(d=(c=g(/^[|~*$^]?=/))&&(b=g(this.entities.quoted)||g(/^[\w-]+/))?[a,c,b.toCSS?b.toCSS():b].join(""):a),g("]")))return d?"["+d+"]":void 0},block:function(){var a;return g("{")&&(a=g(this.primary))&&g("}")?a:void 0},ruleset:function(){var b,e,f,h=[];for(c(),a.dumpLineNumbers&&(f=o(t,s,a));(b=g(this.selector))&&(h.push(b),g(this.comment),g(","));)g(this.comment);if(h.length>0&&(e=g(this.block))){var i=new q.Ruleset(h,e,a.strictImports);return a.dumpLineNumbers&&(i.debugInfo=f),i}x=t,d()},rule:function(){var a,b,e,f,h=s.charAt(t);if(c(),"."!==h&&"#"!==h&&"&"!==h&&(a=g(this.variable)||g(this.property))){if("@"!=a.charAt(0)&&(f=/^([^@+\/'"*`(;{}-]*);/.exec(y[u]))?(t+=f[0].length-1,b=new q.Anonymous(f[1])):b=g("font"===a?this.font:this.value),e=g(this.important),b&&g(this.end))return new q.Rule(a,b,e,w);x=t,d()}},"import":function(){var b,e,f=t;c();var h=g(/^@import(?:-(once))?\s+/);return h&&(b=g(this.entities.quoted)||g(this.entities.url))&&(e=g(this.mediaFeatures),g(";"))?new q.Import(b,C,e,"once"===h[1],f,a.rootpath):void d()},mediaFeature:function(){var a,b,c=[];do if(a=g(this.entities.keyword))c.push(a);else if(g("(")){if(b=g(this.property),a=g(this.entity),!g(")"))return null;if(b&&a)c.push(new q.Paren(new q.Rule(b,a,null,t,!0)));else{if(!a)return null;c.push(new q.Paren(a))}}while(a);return c.length>0?new q.Expression(c):void 0},mediaFeatures:function(){var a,b=[];do if(a=g(this.mediaFeature)){if(b.push(a),!g(","))break}else if((a=g(this.entities.variable))&&(b.push(a),!g(",")))break;while(a);return b.length>0?b:null},media:function(){var b,c,d,e;return a.dumpLineNumbers&&(e=o(t,s,a)),g(/^@media/)&&(b=g(this.mediaFeatures),c=g(this.block))?(d=new q.Media(c,b),a.dumpLineNumbers&&(d.debugInfo=e),d):void 0},directive:function(){var b,e,f,h,i,j,k;if("@"===s.charAt(t)){if(e=g(this["import"])||g(this.media))return e;if(c(),b=g(/^@[a-z-]+/)){switch(h=b,"-"==b.charAt(1)&&b.indexOf("-",2)>0&&(h="@"+b.slice(b.indexOf("-",2)+1)),h){case"@font-face":i=!0;break;case"@viewport":case"@top-left":case"@top-left-corner":case"@top-center":case"@top-right":case"@top-right-corner":case"@bottom-left":case"@bottom-left-corner":case"@bottom-center":case"@bottom-right":case"@bottom-right-corner":case"@left-top":case"@left-middle":case"@left-bottom":case"@right-top":case"@right-middle":case"@right-bottom":i=!0;break;case"@page":case"@document":case"@supports":case"@keyframes":i=!0,j=!0;break;case"@namespace":k=!0}if(j&&(b+=" "+(g(/^[^{]+/)||"").trim()),i){if(f=g(this.block))return new q.Directive(b,f)}else if((e=g(k?this.expression:this.entity))&&g(";")){var l=new q.Directive(b,e);return a.dumpLineNumbers&&(l.debugInfo=o(t,s,a)),l}d()}}},font:function(){for(var a,b=[],c=[];a=g(this.shorthand)||g(this.entity);)c.push(a);if(b.push(new q.Expression(c)),g(","))for(;(a=g(this.expression))&&(b.push(a),g(",")););return new q.Value(b)},value:function(){for(var a,b=[];(a=g(this.expression))&&(b.push(a),g(",")););return b.length>0?new q.Value(b):void 0},important:function(){return"!"===s.charAt(t)?g(/^! *important/):void 0},sub:function(){var a;return g("(")&&(a=g(this.expression))&&g(")")?a:void 0},multiplication:function(){var a,b,c,d;if(a=g(this.operand)){for(;!k(/^\/[*\/]/)&&(c=g("/")||g("*"))&&(b=g(this.operand));)d=new q.Operation(c,[d||a,b]);return d||a}},addition:function(){var a,b,c,d;if(a=g(this.multiplication)){for(;(c=g(/^[-+]\s+/)||!f(s.charAt(t-1))&&(g("+")||g("-")))&&(b=g(this.multiplication));)d=new q.Operation(c,[d||a,b]);return d||a}},conditions:function(){var a,b,c,d=t;if(a=g(this.condition)){for(;g(",")&&(b=g(this.condition));)c=new q.Condition("or",c||a,b,d);return c||a}},condition:function(){var a,b,c,d,e=t,f=!1;return g(/^not/)&&(f=!0),i("("),(a=g(this.addition)||g(this.entities.keyword)||g(this.entities.quoted))?((d=g(/^(?:>=|=<|[<=>])/))?(b=g(this.addition)||g(this.entities.keyword)||g(this.entities.quoted))?c=new q.Condition(d,a,b,e,f):j("expected expression"):c=new q.Condition("=",a,new q.Keyword("true"),e,f),i(")"),g(/^and/)?new q.Condition("and",c,g(this.condition)):c):void 0},operand:function(){var a,b=s.charAt(t+1);"-"===s.charAt(t)&&("@"===b||"("===b)&&(a=g("-"));var c=g(this.sub)||g(this.entities.dimension)||g(this.entities.color)||g(this.entities.variable)||g(this.entities.call);return a?new q.Operation("*",[new q.Dimension(-1),c]):c},expression:function(){for(var a,b=[];a=g(this.addition)||g(this.entity);)b.push(a);return b.length>0?new q.Expression(b):void 0},property:function(){var a;return(a=g(/^(\*?-?[_a-z0-9-]+)\s*:/))?a[1]:void 0}}}},("browser"===p.mode||"rhino"===p.mode)&&(p.Parser.importer=function(a,b,c,d){!/^([a-z-]+:)?\//.test(a)&&b.length>0&&(a=b[0]+a),h({href:a,title:a,type:d.mime,contents:d.contents,files:d.files,rootpath:d.rootpath,entryPath:d.entryPath,relativeUrls:d.relativeUrls},function(a,e,f,g,h,i){a&&"function"==typeof d.errback?d.errback.call(null,i,b,c,d):c.call(null,a,e,i)},!0)}),function(a){function b(b){return a.functions.hsla(b.h,b.s,b.l,b.a)}function c(b,c){return b instanceof a.Dimension&&"%"==b.unit?parseFloat(b.value*c/100):d(b)}function d(b){if(b instanceof a.Dimension)return parseFloat("%"==b.unit?b.value/100:b.value);if("number"==typeof b)return b;throw{error:"RuntimeError",message:"color functions take numbers as parameters"}}function e(a){return Math.min(1,Math.max(0,a))}a.functions={rgb:function(a,b,c){return this.rgba(a,b,c,1)},rgba:function(b,e,f,g){var h=[b,e,f].map(function(a){return c(a,256)});return g=d(g),new a.Color(h,g)},hsl:function(a,b,c){return this.hsla(a,b,c,1)},hsla:function(a,b,c,e){function f(a){return a=0>a?a+1:a>1?a-1:a,1>6*a?h+(g-h)*a*6:1>2*a?g:2>3*a?h+(g-h)*(2/3-a)*6:h}a=d(a)%360/360,b=d(b),c=d(c),e=d(e);var g=.5>=c?c*(b+1):c+b-c*b,h=2*c-g;return this.rgba(255*f(a+1/3),255*f(a),255*f(a-1/3),e)},hsv:function(a,b,c){return this.hsva(a,b,c,1)},hsva:function(a,b,c,e){a=d(a)%360/360*360,b=d(b),c=d(c),e=d(e);var f,g;f=Math.floor(a/60%6),g=a/60-f;var h=[c,c*(1-b),c*(1-g*b),c*(1-(1-g)*b)],i=[[0,3,1],[2,0,1],[1,0,3],[1,2,0],[3,1,0],[0,1,2]];return this.rgba(255*h[i[f][0]],255*h[i[f][1]],255*h[i[f][2]],e)},hue:function(b){return new a.Dimension(Math.round(b.toHSL().h))},saturation:function(b){return new a.Dimension(Math.round(100*b.toHSL().s),"%")},lightness:function(b){return new a.Dimension(Math.round(100*b.toHSL().l),"%")},red:function(b){return new a.Dimension(b.rgb[0])},green:function(b){return new a.Dimension(b.rgb[1])},blue:function(b){return new a.Dimension(b.rgb[2])},alpha:function(b){return new a.Dimension(b.toHSL().a)},luma:function(b){return new a.Dimension(Math.round((.2126*(b.rgb[0]/255)+.7152*(b.rgb[1]/255)+.0722*(b.rgb[2]/255))*b.alpha*100),"%")},saturate:function(a,c){var d=a.toHSL();return d.s+=c.value/100,d.s=e(d.s),b(d)},desaturate:function(a,c){var d=a.toHSL();return d.s-=c.value/100,d.s=e(d.s),b(d)},lighten:function(a,c){var d=a.toHSL();return d.l+=c.value/100,d.l=e(d.l),b(d)},darken:function(a,c){var d=a.toHSL();return d.l-=c.value/100,d.l=e(d.l),b(d)},fadein:function(a,c){var d=a.toHSL();return d.a+=c.value/100,d.a=e(d.a),b(d)},fadeout:function(a,c){var d=a.toHSL();return d.a-=c.value/100,d.a=e(d.a),b(d)},fade:function(a,c){var d=a.toHSL();return d.a=c.value/100,d.a=e(d.a),b(d)},spin:function(a,c){var d=a.toHSL(),e=(d.h+c.value)%360;return d.h=0>e?360+e:e,b(d)},mix:function(b,c,d){d||(d=new a.Dimension(50));var e=d.value/100,f=2*e-1,g=b.toHSL().a-c.toHSL().a,h=((f*g==-1?f:(f+g)/(1+f*g))+1)/2,i=1-h,j=[b.rgb[0]*h+c.rgb[0]*i,b.rgb[1]*h+c.rgb[1]*i,b.rgb[2]*h+c.rgb[2]*i],k=b.alpha*e+c.alpha*(1-e);return new a.Color(j,k)},greyscale:function(b){return this.desaturate(b,new a.Dimension(100))},contrast:function(a,b,c,d){return a.rgb?("undefined"==typeof c&&(c=this.rgba(255,255,255,1)),"undefined"==typeof b&&(b=this.rgba(0,0,0,1)),d="undefined"==typeof d?.43:d.value,(.2126*(a.rgb[0]/255)+.7152*(a.rgb[1]/255)+.0722*(a.rgb[2]/255))*a.alpha<d?c:b):null},e:function(b){return new a.Anonymous(b instanceof a.JavaScript?b.evaluated:b)},escape:function(b){return new a.Anonymous(encodeURI(b.value).replace(/=/g,"%3D").replace(/:/g,"%3A").replace(/#/g,"%23").replace(/;/g,"%3B").replace(/\(/g,"%28").replace(/\)/g,"%29"))},"%":function(b){for(var c=Array.prototype.slice.call(arguments,1),d=b.value,e=0;e<c.length;e++)d=d.replace(/%[sda]/i,function(a){var b=a.match(/s/i)?c[e].value:c[e].toCSS();return a.match(/[A-Z]$/)?encodeURIComponent(b):b});return d=d.replace(/%%/g,"%"),new a.Quoted('"'+d+'"',d)},unit:function(b,c){return new a.Dimension(b.value,c?c.toCSS():"")},round:function(a,b){var c="undefined"==typeof b?0:b.value;return this._math(function(a){return a.toFixed(c)},a)},ceil:function(a){return this._math(Math.ceil,a)},floor:function(a){return this._math(Math.floor,a)},_math:function(b,c){if(c instanceof a.Dimension)return new a.Dimension(b(parseFloat(c.value)),c.unit);if("number"==typeof c)return b(c);throw{type:"Argument",message:"argument must be a number"}},argb:function(b){return new a.Anonymous(b.toARGB())},percentage:function(b){return new a.Dimension(100*b.value,"%")},color:function(b){if(b instanceof a.Quoted)return new a.Color(b.value.slice(1));throw{type:"Argument",message:"argument must be a string"}},iscolor:function(b){return this._isa(b,a.Color)},isnumber:function(b){return this._isa(b,a.Dimension)},isstring:function(b){return this._isa(b,a.Quoted)},iskeyword:function(b){return this._isa(b,a.Keyword)},isurl:function(b){return this._isa(b,a.URL)},ispixel:function(b){return b instanceof a.Dimension&&"px"===b.unit?a.True:a.False},ispercentage:function(b){return b instanceof a.Dimension&&"%"===b.unit?a.True:a.False},isem:function(b){return b instanceof a.Dimension&&"em"===b.unit?a.True:a.False},_isa:function(b,c){return b instanceof c?a.True:a.False},multiply:function(a,b){var c=a.rgb[0]*b.rgb[0]/255,d=a.rgb[1]*b.rgb[1]/255,e=a.rgb[2]*b.rgb[2]/255;return this.rgb(c,d,e)},screen:function(a,b){var c=255-(255-a.rgb[0])*(255-b.rgb[0])/255,d=255-(255-a.rgb[1])*(255-b.rgb[1])/255,e=255-(255-a.rgb[2])*(255-b.rgb[2])/255;return this.rgb(c,d,e)},overlay:function(a,b){var c=a.rgb[0]<128?2*a.rgb[0]*b.rgb[0]/255:255-2*(255-a.rgb[0])*(255-b.rgb[0])/255,d=a.rgb[1]<128?2*a.rgb[1]*b.rgb[1]/255:255-2*(255-a.rgb[1])*(255-b.rgb[1])/255,e=a.rgb[2]<128?2*a.rgb[2]*b.rgb[2]/255:255-2*(255-a.rgb[2])*(255-b.rgb[2])/255;return this.rgb(c,d,e)},softlight:function(a,b){var c=b.rgb[0]*a.rgb[0]/255,d=c+a.rgb[0]*(255-(255-a.rgb[0])*(255-b.rgb[0])/255-c)/255;c=b.rgb[1]*a.rgb[1]/255;var e=c+a.rgb[1]*(255-(255-a.rgb[1])*(255-b.rgb[1])/255-c)/255;c=b.rgb[2]*a.rgb[2]/255;var f=c+a.rgb[2]*(255-(255-a.rgb[2])*(255-b.rgb[2])/255-c)/255;return this.rgb(d,e,f)},hardlight:function(a,b){var c=b.rgb[0]<128?2*b.rgb[0]*a.rgb[0]/255:255-2*(255-b.rgb[0])*(255-a.rgb[0])/255,d=b.rgb[1]<128?2*b.rgb[1]*a.rgb[1]/255:255-2*(255-b.rgb[1])*(255-a.rgb[1])/255,e=b.rgb[2]<128?2*b.rgb[2]*a.rgb[2]/255:255-2*(255-b.rgb[2])*(255-a.rgb[2])/255;return this.rgb(c,d,e)},difference:function(a,b){var c=Math.abs(a.rgb[0]-b.rgb[0]),d=Math.abs(a.rgb[1]-b.rgb[1]),e=Math.abs(a.rgb[2]-b.rgb[2]);return this.rgb(c,d,e)},exclusion:function(a,b){var c=a.rgb[0]+b.rgb[0]*(255-a.rgb[0]-a.rgb[0])/255,d=a.rgb[1]+b.rgb[1]*(255-a.rgb[1]-a.rgb[1])/255,e=a.rgb[2]+b.rgb[2]*(255-a.rgb[2]-a.rgb[2])/255;return this.rgb(c,d,e)},average:function(a,b){var c=(a.rgb[0]+b.rgb[0])/2,d=(a.rgb[1]+b.rgb[1])/2,e=(a.rgb[2]+b.rgb[2])/2;return this.rgb(c,d,e)},negation:function(a,b){var c=255-Math.abs(255-b.rgb[0]-a.rgb[0]),d=255-Math.abs(255-b.rgb[1]-a.rgb[1]),e=255-Math.abs(255-b.rgb[2]-a.rgb[2]);return this.rgb(c,d,e)},tint:function(a,b){return this.mix(this.rgb(255,255,255),a,b)},shade:function(a,b){return this.mix(this.rgb(0,0,0),a,b)}}}(b("./tree")),function(a){a.colors={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgrey:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}}(b("./tree")),function(a){a.Alpha=function(a){this.value=a},a.Alpha.prototype={toCSS:function(){return"alpha(opacity="+(this.value.toCSS?this.value.toCSS():this.value)+")"},eval:function(a){return this.value.eval&&(this.value=this.value.eval(a)),this}}}(b("../tree")),function(a){a.Anonymous=function(a){this.value=a.value||a},a.Anonymous.prototype={toCSS:function(){return this.value},eval:function(){return this},compare:function(a){if(!a.toCSS)return-1;var b=this.toCSS(),c=a.toCSS();return b===c?0:c>b?-1:1}}}(b("../tree")),function(a){a.Assignment=function(a,b){this.key=a,this.value=b},a.Assignment.prototype={toCSS:function(){return this.key+"="+(this.value.toCSS?this.value.toCSS():this.value)},eval:function(b){return this.value.eval?new a.Assignment(this.key,this.value.eval(b)):this}}}(b("../tree")),function(a){a.Call=function(a,b,c,d){this.name=a,this.args=b,this.index=c,this.filename=d},a.Call.prototype={eval:function(b){var c,d=this.args.map(function(a){return a.eval(b)});if(this.name in a.functions)try{if(c=a.functions[this.name].apply(a.functions,d),null!=c)return c}catch(e){throw{type:e.type||"Runtime",message:"error evaluating function `"+this.name+"`"+(e.message?": "+e.message:""),index:this.index,filename:this.filename}}return new a.Anonymous(this.name+"("+d.map(function(a){return a.toCSS(b)}).join(", ")+")")},toCSS:function(a){return this.eval(a).toCSS()}}}(b("../tree")),function(a){a.Color=function(a,b){this.rgb=Array.isArray(a)?a:6==a.length?a.match(/.{2}/g).map(function(a){return parseInt(a,16)}):a.split("").map(function(a){return parseInt(a+a,16)}),this.alpha="number"==typeof b?b:1},a.Color.prototype={eval:function(){return this},toCSS:function(){return this.alpha<1?"rgba("+this.rgb.map(function(a){return Math.round(a)}).concat(this.alpha).join(", ")+")":"#"+this.rgb.map(function(a){return a=Math.round(a),a=(a>255?255:0>a?0:a).toString(16),1===a.length?"0"+a:a}).join("")},operate:function(b,c){var d=[];c instanceof a.Color||(c=c.toColor());for(var e=0;3>e;e++)d[e]=a.operate(b,this.rgb[e],c.rgb[e]);return new a.Color(d,this.alpha+c.alpha)},toHSL:function(){var a,b,c=this.rgb[0]/255,d=this.rgb[1]/255,e=this.rgb[2]/255,f=this.alpha,g=Math.max(c,d,e),h=Math.min(c,d,e),i=(g+h)/2,j=g-h;if(g===h)a=b=0;else{switch(b=i>.5?j/(2-g-h):j/(g+h),g){case c:a=(d-e)/j+(e>d?6:0);break;case d:a=(e-c)/j+2;break;case e:a=(c-d)/j+4}a/=6}return{h:360*a,s:b,l:i,a:f}},toARGB:function(){var a=[Math.round(255*this.alpha)].concat(this.rgb);return"#"+a.map(function(a){return a=Math.round(a),a=(a>255?255:0>a?0:a).toString(16),1===a.length?"0"+a:a}).join("")},compare:function(a){return a.rgb&&a.rgb[0]===this.rgb[0]&&a.rgb[1]===this.rgb[1]&&a.rgb[2]===this.rgb[2]&&a.alpha===this.alpha?0:-1}}}(b("../tree")),function(a){a.Comment=function(a,b){this.value=a,this.silent=!!b},a.Comment.prototype={toCSS:function(a){return a.compress?"":this.value},eval:function(){return this}}}(b("../tree")),function(a){a.Condition=function(a,b,c,d,e){this.op=a.trim(),this.lvalue=b,this.rvalue=c,this.index=d,this.negate=e},a.Condition.prototype.eval=function(a){var b,c=this.lvalue.eval(a),d=this.rvalue.eval(a),e=this.index,b=function(a){switch(a){case"and":return c&&d;case"or":return c||d;default:if(c.compare)b=c.compare(d);else{if(!d.compare)throw{type:"Type",message:"Unable to perform comparison",index:e};b=d.compare(c)}switch(b){case-1:return"<"===a||"=<"===a;case 0:return"="===a||">="===a||"=<"===a;case 1:return">"===a||">="===a}}}(this.op);return this.negate?!b:b}}(b("../tree")),function(a){a.Dimension=function(a,b){this.value=parseFloat(a),this.unit=b||null},a.Dimension.prototype={eval:function(){return this},toColor:function(){return new a.Color([this.value,this.value,this.value])},toCSS:function(){var a=this.value+this.unit;return a},operate:function(b,c){return new a.Dimension(a.operate(b,this.value,c.value),this.unit||c.unit)},compare:function(b){return b instanceof a.Dimension?b.value>this.value?-1:b.value<this.value?1:b.unit&&this.unit!==b.unit?-1:0:-1}}}(b("../tree")),function(a){a.Directive=function(b,c){this.name=b,Array.isArray(c)?(this.ruleset=new a.Ruleset([],c),this.ruleset.allowImports=!0):this.value=c},a.Directive.prototype={toCSS:function(a,b){return this.ruleset?(this.ruleset.root=!0,this.name+(b.compress?"{":" {\n  ")+this.ruleset.toCSS(a,b).trim().replace(/\n/g,"\n  ")+(b.compress?"}":"\n}\n")):this.name+" "+this.value.toCSS()+";\n"},eval:function(b){var c=this;return this.ruleset&&(b.frames.unshift(this),c=new a.Directive(this.name),c.ruleset=this.ruleset.eval(b),b.frames.shift()),c},variable:function(b){return a.Ruleset.prototype.variable.call(this.ruleset,b)},find:function(){return a.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return a.Ruleset.prototype.rulesets.apply(this.ruleset)}}}(b("../tree")),function(a){a.Element=function(b,c,d){this.combinator=b instanceof a.Combinator?b:new a.Combinator(b),this.value="string"==typeof c?c.trim():c?c:"",this.index=d},a.Element.prototype.eval=function(b){return new a.Element(this.combinator,this.value.eval?this.value.eval(b):this.value,this.index)},a.Element.prototype.toCSS=function(a){var b=this.value.toCSS?this.value.toCSS(a):this.value;return""==b&&"&"==this.combinator.value.charAt(0)?"":this.combinator.toCSS(a||{})+b},a.Combinator=function(a){this.value=" "===a?" ":a?a.trim():""},a.Combinator.prototype.toCSS=function(a){return{"":""," ":" ",":":" :","+":a.compress?"+":" + ","~":a.compress?"~":" ~ ",">":a.compress?">":" > ","|":a.compress?"|":" | "}[this.value]}}(b("../tree")),function(a){a.Expression=function(a){this.value=a},a.Expression.prototype={eval:function(b){return this.value.length>1?new a.Expression(this.value.map(function(a){return a.eval(b)})):1===this.value.length?this.value[0].eval(b):this},toCSS:function(a){return this.value.map(function(b){return b.toCSS?b.toCSS(a):""}).join(" ")}}}(b("../tree")),function(a){a.Import=function(b,c,d,e,f,g){var h=this;this.once=e,this.index=f,this._path=b,this.features=d&&new a.Value(d),this.rootpath=g,this.path=b instanceof a.Quoted?/(\.[a-z]*$)|([\?;].*)$/.test(b.value)?b.value:b.value+".less":b.value.value||b.value,this.css=/css([\?;].*)?$/.test(this.path),this.css||c.push(this.path,function(b,c,d){b&&(b.index=f),d&&h.once&&(h.skip=d),h.root=c||new a.Ruleset([],[])})},a.Import.prototype={toCSS:function(a){var b=this.features?" "+this.features.toCSS(a):"";return this.css?("string"==typeof this._path.value&&!/^(?:[a-z-]+:|\/)/.test(this._path.value)&&(this._path.value=this.rootpath+this._path.value),"@import "+this._path.toCSS()+b+";\n"):""},eval:function(b){{var c;this.features&&this.features.eval(b)}return this.skip?[]:this.css?this:(c=new a.Ruleset([],this.root.rules.slice(0)),c.evalImports(b),this.features?new a.Media(c.rules,this.features.value):c.rules)}}}(b("../tree")),function(a){a.JavaScript=function(a,b,c){this.escaped=c,this.expression=a,this.index=b},a.JavaScript.prototype={eval:function(b){var c,d=this,e={},f=this.expression.replace(/@\{([\w-]+)\}/g,function(c,e){return a.jsify(new a.Variable("@"+e,d.index).eval(b))});try{f=new Function("return ("+f+")")}catch(g){throw{message:"JavaScript evaluation error: `"+f+"`",index:this.index}}for(var h in b.frames[0].variables())e[h.slice(1)]={value:b.frames[0].variables()[h].value,toJS:function(){return this.value.eval(b).toCSS()}};try{c=f.call(e)}catch(g){throw{message:"JavaScript evaluation error: '"+g.name+": "+g.message+"'",index:this.index}}return"string"==typeof c?new a.Quoted('"'+c+'"',c,this.escaped,this.index):new a.Anonymous(Array.isArray(c)?c.join(", "):c)}}}(b("../tree")),function(a){a.Keyword=function(a){this.value=a},a.Keyword.prototype={eval:function(){return this},toCSS:function(){return this.value},compare:function(b){return b instanceof a.Keyword?b.value===this.value?0:1:-1}},a.True=new a.Keyword("true"),a.False=new a.Keyword("false")}(b("../tree")),function(a){a.Media=function(b,c){var d=this.emptySelectors();this.features=new a.Value(c),this.ruleset=new a.Ruleset(d,b),this.ruleset.allowImports=!0},a.Media.prototype={toCSS:function(a,b){var c=this.features.toCSS(b);return this.ruleset.root=0===a.length||a[0].multiMedia,"@media "+c+(b.compress?"{":" {\n  ")+this.ruleset.toCSS(a,b).trim().replace(/\n/g,"\n  ")+(b.compress?"}":"\n}\n")},eval:function(b){b.mediaBlocks||(b.mediaBlocks=[],b.mediaPath=[]);var c=new a.Media([],[]);return this.debugInfo&&(this.ruleset.debugInfo=this.debugInfo,c.debugInfo=this.debugInfo),c.features=this.features.eval(b),b.mediaPath.push(c),b.mediaBlocks.push(c),b.frames.unshift(this.ruleset),c.ruleset=this.ruleset.eval(b),b.frames.shift(),b.mediaPath.pop(),0===b.mediaPath.length?c.evalTop(b):c.evalNested(b)},variable:function(b){return a.Ruleset.prototype.variable.call(this.ruleset,b)},find:function(){return a.Ruleset.prototype.find.apply(this.ruleset,arguments)},rulesets:function(){return a.Ruleset.prototype.rulesets.apply(this.ruleset)},emptySelectors:function(){var b=new a.Element("","&",0);return[new a.Selector([b])]},evalTop:function(b){var c=this;if(b.mediaBlocks.length>1){var d=this.emptySelectors();c=new a.Ruleset(d,b.mediaBlocks),c.multiMedia=!0}return delete b.mediaBlocks,delete b.mediaPath,c},evalNested:function(b){var c,d,e=b.mediaPath.concat([this]);for(c=0;c<e.length;c++)d=e[c].features instanceof a.Value?e[c].features.value:e[c].features,e[c]=Array.isArray(d)?d:[d];return this.features=new a.Value(this.permute(e).map(function(b){for(b=b.map(function(b){return b.toCSS?b:new a.Anonymous(b)}),c=b.length-1;c>0;c--)b.splice(c,0,new a.Anonymous("and"));return new a.Expression(b)})),new a.Ruleset([],[])},permute:function(a){if(0===a.length)return[];if(1===a.length)return a[0];for(var b=[],c=this.permute(a.slice(1)),d=0;d<c.length;d++)for(var e=0;e<a[0].length;e++)b.push([a[0][e]].concat(c[d]));return b},bubbleSelectors:function(b){this.ruleset=new a.Ruleset(b.slice(0),[this.ruleset])}}}(b("../tree")),function(a){a.mixin={},a.mixin.Call=function(b,c,d,e,f){this.selector=new a.Selector(b),this.arguments=c,this.index=d,this.filename=e,this.important=f},a.mixin.Call.prototype={eval:function(b){var c,d,e,f,g,h,i,j,k=[],l=!1;for(e=this.arguments&&this.arguments.map(function(a){return{name:a.name,value:a.value.eval(b)}}),f=0;f<b.frames.length;f++)if((c=b.frames[f].find(this.selector)).length>0){for(j=!0,g=0;g<c.length;g++){for(d=c[g],i=!1,h=0;h<b.frames.length;h++)if(!(d instanceof a.mixin.Definition)&&d===(b.frames[h].originalRuleset||b.frames[h])){i=!0;break}if(!i&&d.matchArgs(e,b)){if(!d.matchCondition||d.matchCondition(e,b))try{Array.prototype.push.apply(k,d.eval(b,e,this.important).rules)}catch(m){throw{message:m.message,index:this.index,filename:this.filename,stack:m.stack}}l=!0}}if(l)return k}throw j?{type:"Runtime",message:"No matching definition was found for `"+this.selector.toCSS().trim()+"("+(e?e.map(function(a){var b="";return a.name&&(b+=a.name+":"),b+=a.value.toCSS?a.value.toCSS():"???"}).join(", "):"")+")`",index:this.index,filename:this.filename}:{type:"Name",message:this.selector.toCSS().trim()+" is undefined",index:this.index,filename:this.filename}}},a.mixin.Definition=function(b,c,d,e,f){this.name=b,this.selectors=[new a.Selector([new a.Element(null,b)])],this.params=c,this.condition=e,this.variadic=f,this.arity=c.length,this.rules=d,this._lookups={},this.required=c.reduce(function(a,b){return!b.name||b.name&&!b.value?a+1:a},0),this.parent=a.Ruleset.prototype,this.frames=[]},a.mixin.Definition.prototype={toCSS:function(){return""},variable:function(a){return this.parent.variable.call(this,a)},variables:function(){return this.parent.variables.call(this)},find:function(){return this.parent.find.apply(this,arguments)},rulesets:function(){return this.parent.rulesets.apply(this)},evalParams:function(b,c,d,e){var f,g,h,i,j,k,l,m,n=new a.Ruleset(null,[]),o=this.params.slice(0);if(d)for(d=d.slice(0),h=0;h<d.length;h++)if(g=d[h],k=g&&g.name){for(l=!1,i=0;i<o.length;i++)if(!e[i]&&k===o[i].name){e[i]=g.value.eval(b),n.rules.unshift(new a.Rule(k,g.value.eval(b))),l=!0;break}if(l){d.splice(h,1),h--;continue}throw{type:"Runtime",message:"Named argument for "+this.name+" "+d[h].name+" not found"}}for(m=0,h=0;h<o.length;h++)if(!e[h]){if(g=d&&d[m],k=o[h].name)if(o[h].variadic&&d){for(f=[],i=m;i<d.length;i++)f.push(d[i].value.eval(b));n.rules.unshift(new a.Rule(k,new a.Expression(f).eval(b)))}else{if(j=g&&g.value)j=j.eval(b);else{if(!o[h].value)throw{type:"Runtime",message:"wrong number of arguments for "+this.name+" ("+d.length+" for "+this.arity+")"};j=o[h].value.eval(c)}n.rules.unshift(new a.Rule(k,j)),e[h]=j}if(o[h].variadic&&d)for(i=m;i<d.length;i++)e[i]=d[i].value.eval(b);m++}return n},eval:function(b,c,d){var e,f,g=[],h=this.frames.concat(b.frames),i=this.evalParams(b,{frames:h},c,g);return i.rules.unshift(new a.Rule("@arguments",new a.Expression(g).eval(b))),e=d?this.parent.makeImportant.apply(this).rules:this.rules.slice(0),f=new a.Ruleset(null,e).eval({frames:[this,i].concat(h)}),f.originalRuleset=this,f},matchCondition:function(a,b){return this.condition&&!this.condition.eval({frames:[this.evalParams(b,{frames:this.frames.concat(b.frames)},a,[])].concat(b.frames)})?!1:!0},matchArgs:function(a,b){var c,d=a&&a.length||0;if(!this.variadic){if(d<this.required)return!1;if(d>this.params.length)return!1;if(this.required>0&&d>this.params.length)return!1}c=Math.min(d,this.arity);for(var e=0;c>e;e++)if(!this.params[e].name&&!this.params[e].variadic&&a[e].value.eval(b).toCSS()!=this.params[e].value.eval(b).toCSS())return!1;return!0}}}(b("../tree")),function(a){a.Operation=function(a,b){this.op=a.trim(),this.operands=b},a.Operation.prototype.eval=function(b){var c,d=this.operands[0].eval(b),e=this.operands[1].eval(b);if(d instanceof a.Dimension&&e instanceof a.Color){if("*"!==this.op&&"+"!==this.op)throw{name:"OperationError",message:"Can't substract or divide a color from a number"};c=e,e=d,d=c}if(!d.operate)throw{name:"OperationError",message:"Operation on an invalid type"};return d.operate(this.op,e)},a.operate=function(a,b,c){switch(a){case"+":return b+c;case"-":return b-c;case"*":return b*c;case"/":return b/c}}}(b("../tree")),function(a){a.Paren=function(a){this.value=a},a.Paren.prototype={toCSS:function(a){return"("+this.value.toCSS(a)+")"},eval:function(b){return new a.Paren(this.value.eval(b))}}}(b("../tree")),function(a){a.Quoted=function(a,b,c,d){this.escaped=c,this.value=b||"",this.quote=a.charAt(0),this.index=d},a.Quoted.prototype={toCSS:function(){return this.escaped?this.value:this.quote+this.value+this.quote},eval:function(b){var c=this,d=this.value.replace(/`([^`]+)`/g,function(d,e){return new a.JavaScript(e,c.index,!0).eval(b).value}).replace(/@\{([\w-]+)\}/g,function(d,e){var f=new a.Variable("@"+e,c.index).eval(b);return f instanceof a.Quoted?f.value:f.toCSS()});return new a.Quoted(this.quote+d+this.quote,d,this.escaped,this.index)},compare:function(a){if(!a.toCSS)return-1;var b=this.toCSS(),c=a.toCSS();return b===c?0:c>b?-1:1}}}(b("../tree")),function(a){a.Ratio=function(a){this.value=a},a.Ratio.prototype={toCSS:function(){return this.value},eval:function(){return this}}}(b("../tree")),function(a){a.Rule=function(b,c,d,e,f){this.name=b,this.value=c instanceof a.Value?c:new a.Value([c]),this.important=d?" "+d.trim():"",this.index=e,this.inline=f||!1,this.variable="@"===b.charAt(0)?!0:!1},a.Rule.prototype.toCSS=function(a){return this.variable?"":this.name+(a.compress?":":": ")+this.value.toCSS(a)+this.important+(this.inline?"":";")},a.Rule.prototype.eval=function(b){return new a.Rule(this.name,this.value.eval(b),this.important,this.index,this.inline)},a.Rule.prototype.makeImportant=function(){return new a.Rule(this.name,this.value,"!important",this.index,this.inline)},a.Shorthand=function(a,b){this.a=a,this.b=b},a.Shorthand.prototype={toCSS:function(a){return this.a.toCSS(a)+"/"+this.b.toCSS(a)},eval:function(){return this}}}(b("../tree")),function(a){a.Ruleset=function(a,b,c){this.selectors=a,this.rules=b,this._lookups={},this.strictImports=c},a.Ruleset.prototype={eval:function(b){var c,d=this.selectors&&this.selectors.map(function(a){return a.eval(b)
}),e=new a.Ruleset(d,this.rules.slice(0),this.strictImports);e.originalRuleset=this,e.root=this.root,e.allowImports=this.allowImports,this.debugInfo&&(e.debugInfo=this.debugInfo),b.frames.unshift(e),(e.root||e.allowImports||!e.strictImports)&&e.evalImports(b);for(var f=0;f<e.rules.length;f++)e.rules[f]instanceof a.mixin.Definition&&(e.rules[f].frames=b.frames.slice(0));for(var g=b.mediaBlocks&&b.mediaBlocks.length||0,f=0;f<e.rules.length;f++)e.rules[f]instanceof a.mixin.Call&&(c=e.rules[f].eval(b),e.rules.splice.apply(e.rules,[f,1].concat(c)),f+=c.length-1,e.resetCache());for(var h,f=0;f<e.rules.length;f++)h=e.rules[f],h instanceof a.mixin.Definition||(e.rules[f]=h.eval?h.eval(b):h);if(b.frames.shift(),b.mediaBlocks)for(var f=g;f<b.mediaBlocks.length;f++)b.mediaBlocks[f].bubbleSelectors(d);return e},evalImports:function(b){var c,d;for(c=0;c<this.rules.length;c++)this.rules[c]instanceof a.Import&&(d=this.rules[c].eval(b),"number"==typeof d.length?(this.rules.splice.apply(this.rules,[c,1].concat(d)),c+=d.length-1):this.rules.splice(c,1,d),this.resetCache())},makeImportant:function(){return new a.Ruleset(this.selectors,this.rules.map(function(a){return a.makeImportant?a.makeImportant():a}),this.strictImports)},matchArgs:function(a){return!a||0===a.length},resetCache:function(){this._rulesets=null,this._variables=null,this._lookups={}},variables:function(){return this._variables?this._variables:this._variables=this.rules.reduce(function(b,c){return c instanceof a.Rule&&c.variable===!0&&(b[c.name]=c),b},{})},variable:function(a){return this.variables()[a]},rulesets:function(){return this._rulesets?this._rulesets:this._rulesets=this.rules.filter(function(b){return b instanceof a.Ruleset||b instanceof a.mixin.Definition})},find:function(b,c){c=c||this;var d,e=[],f=b.toCSS();return f in this._lookups?this._lookups[f]:(this.rulesets().forEach(function(f){if(f!==c)for(var g=0;g<f.selectors.length;g++)if(d=b.match(f.selectors[g])){b.elements.length>f.selectors[g].elements.length?Array.prototype.push.apply(e,f.find(new a.Selector(b.elements.slice(1)),c)):e.push(f);break}}),this._lookups[f]=e)},toCSS:function(b,c){var d,e,f,g=[],h=[],i=[],j=[],k=[];this.root||this.joinSelectors(k,b,this.selectors);for(var l=0;l<this.rules.length;l++)if(f=this.rules[l],f.rules||f instanceof a.Media)j.push(f.toCSS(k,c));else if(f instanceof a.Directive){var m=f.toCSS(k,c);if("@charset"===f.name){if(c.charset){f.debugInfo&&(j.push(a.debugInfo(c,f)),j.push(new a.Comment("/* "+m.replace(/\n/g,"")+" */\n").toCSS(c)));continue}c.charset=!0}j.push(m)}else f instanceof a.Comment?f.silent||(this.root?j.push(f.toCSS(c)):h.push(f.toCSS(c))):f.toCSS&&!f.variable?h.push(f.toCSS(c)):f.value&&!f.variable&&h.push(f.value.toString());if(j=j.join(""),this.root)g.push(h.join(c.compress?"":"\n"));else if(h.length>0){e=a.debugInfo(c,this),d=k.map(function(a){return a.map(function(a){return a.toCSS(c)}).join("").trim()}).join(c.compress?",":",\n");for(var l=h.length-1;l>=0;l--)-1===i.indexOf(h[l])&&i.unshift(h[l]);h=i,g.push(e+d+(c.compress?"{":" {\n  ")+h.join(c.compress?"":"\n  ")+(c.compress?"}":"\n}\n"))}return g.push(j),g.join("")+(c.compress?"\n":"")},joinSelectors:function(a,b,c){for(var d=0;d<c.length;d++)this.joinSelector(a,b,c[d])},joinSelector:function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(e=0;e<d.elements.length;e++)j=d.elements[e],"&"===j.value&&(h=!0);if(h){for(r=[],i=[[]],e=0;e<d.elements.length;e++)if(j=d.elements[e],"&"!==j.value)r.push(j);else{for(s=[],r.length>0&&this.mergeElementsOnToSelectors(r,i),f=0;f<i.length;f++)if(k=i[f],0==c.length)k.length>0&&(k[0].elements=k[0].elements.slice(0),k[0].elements.push(new a.Element(j.combinator,"",0))),s.push(k);else for(g=0;g<c.length;g++)l=c[g],m=[],n=[],p=!0,k.length>0?(m=k.slice(0),q=m.pop(),o=new a.Selector(q.elements.slice(0)),p=!1):o=new a.Selector([]),l.length>1&&(n=n.concat(l.slice(1))),l.length>0&&(p=!1,o.elements.push(new a.Element(j.combinator,l[0].elements[0].value,0)),o.elements=o.elements.concat(l[0].elements.slice(1))),p||m.push(o),m=m.concat(n),s.push(m);i=s,r=[]}for(r.length>0&&this.mergeElementsOnToSelectors(r,i),e=0;e<i.length;e++)b.push(i[e])}else if(c.length>0)for(e=0;e<c.length;e++)b.push(c[e].concat(d));else b.push([d])},mergeElementsOnToSelectors:function(b,c){var d,e;if(0==c.length)return void c.push([new a.Selector(b)]);for(d=0;d<c.length;d++)e=c[d],e.length>0?e[e.length-1]=new a.Selector(e[e.length-1].elements.concat(b)):e.push(new a.Selector(b))}}}(b("../tree")),function(a){a.Selector=function(a){this.elements=a},a.Selector.prototype.match=function(a){var b,c,d,e,f=this.elements,g=f.length;if(b=a.elements.slice(a.elements.length&&"&"===a.elements[0].value?1:0),c=b.length,d=Math.min(g,c),0===c||c>g)return!1;for(e=0;d>e;e++)if(f[e].value!==b[e].value)return!1;return!0},a.Selector.prototype.eval=function(b){return new a.Selector(this.elements.map(function(a){return a.eval(b)}))},a.Selector.prototype.toCSS=function(a){return this._css?this._css:(this._css=""===this.elements[0].combinator.value?" ":"",this._css+=this.elements.map(function(b){return"string"==typeof b?" "+b.trim():b.toCSS(a)}).join(""),this._css)}}(b("../tree")),function(a){a.UnicodeDescriptor=function(a){this.value=a},a.UnicodeDescriptor.prototype={toCSS:function(){return this.value},eval:function(){return this}}}(b("../tree")),function(a){a.URL=function(a,b){this.value=a,this.rootpath=b},a.URL.prototype={toCSS:function(){return"url("+this.value.toCSS()+")"},eval:function(b){var c,d=this.value.eval(b);return"string"==typeof d.value&&!/^(?:[a-z-]+:|\/)/.test(d.value)&&(c=this.rootpath,d.quote||(c=c.replace(/[\(\)'"\s]/g,function(a){return"\\"+a})),d.value=c+d.value),new a.URL(d,this.rootpath)}}}(b("../tree")),function(a){a.Value=function(a){this.value=a,this.is="value"},a.Value.prototype={eval:function(b){return 1===this.value.length?this.value[0].eval(b):new a.Value(this.value.map(function(a){return a.eval(b)}))},toCSS:function(a){return this.value.map(function(b){return b.toCSS(a)}).join(a.compress?",":", ")}}}(b("../tree")),function(a){a.Variable=function(a,b,c){this.name=a,this.index=b,this.file=c},a.Variable.prototype={eval:function(b){var c,d,e=this.name;if(0==e.indexOf("@@")&&(e="@"+new a.Variable(e.slice(1)).eval(b).value),this.evaluating)throw{type:"Name",message:"Recursive variable definition for "+e,filename:this.file,index:this.index};if(this.evaluating=!0,c=a.find(b.frames,function(a){return(d=a.variable(e))?d.value.eval(b):void 0}))return this.evaluating=!1,c;throw{type:"Name",message:"variable "+e+" is undefined",filename:this.file,index:this.index}}}}(b("../tree")),function(a){a.debugInfo=function(b,c){var d="";if(b.dumpLineNumbers&&!b.compress)switch(b.dumpLineNumbers){case"comments":d=a.debugInfo.asComment(c);break;case"mediaquery":d=a.debugInfo.asMediaQuery(c);break;case"all":d=a.debugInfo.asComment(c)+a.debugInfo.asMediaQuery(c)}return d},a.debugInfo.asComment=function(a){return"/* line "+a.debugInfo.lineNumber+", "+a.debugInfo.fileName+" */\n"},a.debugInfo.asMediaQuery=function(a){return"@media -sass-debug-info{filename{font-family:"+("file://"+a.debugInfo.fileName).replace(/[\/:.]/g,"\\$&")+"}line{font-family:\\00003"+a.debugInfo.lineNumber+"}}\n"},a.find=function(a,b){for(var c,d=0;d<a.length;d++)if(c=b.call(a,a[d]))return c;return null},a.jsify=function(a){return Array.isArray(a.value)&&a.value.length>1?"["+a.value.map(function(a){return a.toCSS(!1)}).join(", ")+"]":a.toCSS(!1)}}(b("./tree"));var r=/^(file|chrome(-extension)?|resource|qrc|app):/.test(location.protocol);if(p.env=p.env||("127.0.0.1"==location.hostname||"0.0.0.0"==location.hostname||"localhost"==location.hostname||location.port.length>0||r?"development":"production"),p.async=p.async||!1,p.fileAsync=p.fileAsync||!1,p.poll=p.poll||(r?1e3:1500),p.functions)for(var s in p.functions)p.tree.functions[s]=p.functions[s];var t=/!dumpLineNumbers:(comments|mediaquery|all)/.exec(location.hash);t&&(p.dumpLineNumbers=t[1]),p.watch=function(){return p.watchMode||(p.env="development",c()),this.watchMode=!0},p.unwatch=function(){return clearInterval(p.watchTimer),this.watchMode=!1},/!watch/.test(location.hash)&&p.watch();var u=null;if("development"!=p.env)try{u="undefined"==typeof a.localStorage?null:a.localStorage}catch(v){}var w=document.getElementsByTagName("link"),x=/^text\/(x-)?less$/;p.sheets=[];for(var y=0;y<w.length;y++)("stylesheet/less"===w[y].rel||w[y].rel.match(/stylesheet/)&&w[y].type.match(x))&&p.sheets.push(w[y]);var z="";p.modifyVars=function(a){var b=z;for(name in a)b+=("@"===name.slice(0,1)?"":"@")+name+": "+(";"===a[name].slice(-1)?a[name]:a[name]+";");(new p.Parser).parse(b,function(a,b){j(b.toCSS(),p.sheets[p.sheets.length-1])})},p.refresh=function(a){var b,c;b=c=new Date,e(function(a,d,e,f,g){g.local?n("loading "+f.href+" from cache."):(n("parsed "+f.href+" successfully."),j(d.toCSS(),f,g.lastModified)),n("css for "+f.href+" generated in "+(new Date-c)+"ms"),0===g.remaining&&n("css generated in "+(new Date-b)+"ms"),c=new Date},a),d()},p.refreshStyles=d,p.refresh("development"===p.env),"function"==typeof define&&define.amd&&define("less",[],function(){return p})}(window),angular.module("ngSharePoint").directive("spfieldAttachments",["$compile","$templateCache","$http","$q","$filter","SharePoint",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:'<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>',link:function(d,e,f,g){function h(b){var c=a(b)(d);e.replaceWith(c),e=c}function i(a){c.get("templates/form-templates/spfield-attachments-"+a+".html",{cache:b}).success(function(a){h(a)})}d.schema=g[0].getFieldSchema(f.name),d.DeleteAttachmentText=STSHtmlEncode(Strings.STS.L_DeleteDocItem_Text),d.AttachFileText=Resources.core.cui_ButAttachFile,d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h('<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>'),d.$parent.item.getAttachments().then(function(a){d.attachmentFiles=a,i(d.currentMode)},function(a){d.errorMsg=a.message,h('<span style="color: brown">{{errorMsg}}</span>')})},!0),d.onFileSelect=function(a,b){angular.forEach(a,function(a){for(var b=-1,c=0;c<d.attachmentFiles.length;c++)if(d.attachmentFiles[c].FileName==a.name){b=c;break}b>=0?alert(Strings.STS.L_ConflictReplaceTitle+" '"+a.name+"'."):(d.$parent.item.attachments.add.push(a),d.attachmentFiles.push({FileName:a.name,local:!0}))}),b.target.value=""},d.removeAttachment=function(a,b){if(b){for(var c=0;c<d.$parent.item.attachments.add.length;c++)if(d.$parent.item.attachments.add[c].name==d.attachmentFiles[a].FileName){d.$parent.item.attachments.add.splice(c,1);break}d.attachmentFiles.splice(a,1)}else{var e=Strings.STS.L_ConfirmDelete_TXT;recycleBinEnabled&&(e=Strings.STS.L_ConfirmRecycle_TXT),confirm(e)&&(d.$parent.item.attachments.remove.push(d.attachmentFiles[a].FileName),d.attachmentFiles.splice(a,1))}}}}}]),angular.module("ngSharePoint").directive("fileSelect",["$parse","$timeout",function(a,b){return function(c,d,e){var f=a(e.fileSelect);if("input"!==d[0].tagName.toLowerCase()||"file"!==(d.attr("type")&&d.attr("type").toLowerCase())){for(var g=angular.element('<input type="file">'),h=0;h<d[0].attributes.length;h++)g.attr(d[0].attributes[h].name,d[0].attributes[h].value);d.attr("data-multiple")&&g.attr("multiple","true"),g.css({position:"absolute",top:"0px",bottom:"0px",right:"0px",width:"200%",margin:"0px",padding:"0px",opacity:"0",filter:"alpha(opacity=0)","z-index":"1000",cursor:"pointer"}),d.append(g),g.parent()[0]!=d[0]&&(d.wrap("<span>"),d.css("z-index","-1000"),d.parent().append(g),d=d.parent()),(""===d.css("position")||"static"===d.css("position"))&&d.css("position","relative"),d.css({display:"inline-block",overflow:"hidden",cursor:"pointer"}),d=g}d.bind("change",function(a){var d=[],e=a.__files_||a.target.files;if(null!==e)for(var g=0;g<e.length;g++)d.push(e.item(g));b(function(){f(c,{$files:d,$event:a})})})}}]),angular.module("ngSharePoint").directive("spfieldBoolean",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-boolean-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.$watch("value",function(a){d.displayValue=STSHtmlEncode(a?Strings.STS.L_SPYes:Strings.STS.L_SPNo)}),d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldCalculated",["$compile","$templateCache","$http",function(){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{value:"=ngModel"},templateUrl:"templates/form-templates/spfield-text-display.html"}}]),angular.module("ngSharePoint").directive("spfieldChoice",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-choice-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.choices=d.schema.Choices.results,d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldControl",["$compile","$templateCache","$http",function(a){return{restrict:"EA",require:"^spform",replace:!0,templateUrl:"templates/form-templates/spfield-control.html",link:function(b,c,d,e){if(b.fieldSchema=e.getFieldSchema(d.name),void 0!==b.fieldSchema){if(e.initField(d.name),"hidden"==d.mode)return void c.addClass("ng-hide");var f=b.fieldSchema.TypeAsString;"UserMulti"===f&&(f="User");var g=d.name+("Lookup"==f||"LookupMulti"==f||"User"==f||"UserMulti"==f?"Id":"");if(("Lookup"==f||"LookupMulti"==f)&&null!==b.fieldSchema.PrimaryFieldId){var h=e.getFieldSchema(b.fieldSchema.PrimaryFieldId);void 0!==h&&(g=h.InternalName+"Id")}var i=d.mode?' mode="'+d.mode+'"':"",j=d.dependsOn?' depends-on="'+d.dependsOn+'"':"",k="hidden"==d.mode?' ng-hide="true"':"",l="<spfield-"+f+' ng-model="item.'+g+'" name="'+d.name+'"'+i+j+k+"></spfield-"+f+">";c.append(l),a(c)(b)}else console.error("Unknown field "+d.name)}}}]),angular.module("ngSharePoint").directive("spfieldCurrency",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-currency-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.cultureInfo="undefined"==typeof __cultureInfo?Sys.CultureInfo.CurrentCulture:__cultureInfo,d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldDatetime",["$compile","$templateCache","$http","$filter","$timeout","$q","SPUtils",function(a,b,c,d,e,f,g){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(h,i,j,k){function l(){var a=f.defer();return k[0].getWebRegionalSettings().then(function(b){h.webRegionalSettings=b,g.getRegionalSettings().then(function(a){h.regionalSettings=a,h.direction=a.get_isRightToLeft()?"rtl":"ltr"}),g.getCurrentUserLCID().then(function(b){h.lcid=b,h.cultureInfo="undefined"==typeof __cultureInfo?Sys.CultureInfo.CurrentCulture:__cultureInfo;var c=["00","05","10","15","20","25","30","35","40","45","50","55"],e=["12 AM","1 AM","2 AM","3 AM","4 AM","5 AM","6 AM","7 AM","8 AM","9 AM","10 AM","11 AM","12 PM","1 PM","2 PM","3 PM","4 PM","5 PM","6 PM","7 PM","8 PM","9 PM","10 PM","11 PM"],f=["00:","01:","02:","03:","04:","05:","06:","07:","08:","09:","10:","11:","12:","13:","14:","15:","16:","17:","18:","19:","20:","21:","22:","23:"],g="01:59:59.9999809",i="0111110",j="109207",k="2666269";if(h.hoursMode24=h.webRegionalSettings.Time24,h.idPrefix=h.schema.InternalName+"_"+h.schema.Id,h.minutes=c,h.hours=h.hoursMode24?f:e,h.datePickerPath=p(),h.datePickerUrl=STSHtmlEncode(h.datePickerPath)+"iframe.aspx?cal="+STSHtmlEncode(String(h.webRegionalSettings.CalendarType))+"&lcid="+STSHtmlEncode(h.lcid)+"&langid="+STSHtmlEncode(_spPageContextInfo.currentLanguage)+"&tz="+STSHtmlEncode(g)+"&ww="+STSHtmlEncode(i)+"&fdow="+STSHtmlEncode(h.webRegionalSettings.FirstDayOfWeek)+"&fwoy="+STSHtmlEncode(h.webRegionalSettings.FirstWeekOfYear)+"&hj="+STSHtmlEncode(h.webRegionalSettings.AdjustHijriDays)+"&swn="+STSHtmlEncode(h.webRegionalSettings.ShowWeeks)+"&minjday="+STSHtmlEncode(j)+"&maxjday="+STSHtmlEncode(k)+"&date=",h.DatePickerFrameID=g_strDatePickerFrameID,h.DatePickerImageID=g_strDatePickerImageID,null!==h.value&&void 0!==h.value){h.dateModel=new Date(h.value),h.dateOnlyModel=d("date")(h.dateModel,h.cultureInfo.dateTimeFormat.ShortDatePattern),h.minutesModel=h.dateModel.getMinutes().toString();var l=h.dateModel.getHours();h.hoursModel=l.toString()+(h.hoursMode24?":":""),10>l&&(h.hoursModel="0"+h.hoursModel)}else h.dateModel=h.dateOnlyModel=h.minutesModel=h.hoursModel=null;a.resolve()})}),a.promise}function m(){var a=this,b=this.resultfunc;this.resultfunc=function(){b(),e(function(){h.$apply(function(){h.dateOnlyModel=a.resultfield.value})})}}function n(a,b){if(a!==b&&void 0!==h.dateOnlyModel&&null!==h.dateOnlyModel){for(var c=h.dateOnlyModel.split(h.cultureInfo.dateTimeFormat.DateSeparator),d=h.cultureInfo.dateTimeFormat.ShortDatePattern.split(h.cultureInfo.dateTimeFormat.DateSeparator),e={},f=0;f<d.length;f++)e[d[f]]=c[f];var g=h.hoursModel;null!==g&&(g=h.hoursMode24?g.substr(0,g.length-1):g.substr(0,2));var i=h.minutesModel,j=new Date(Date.UTC(e.yyyy,(e.MM||e.M)-1,e.dd||e.d,g,i));h.value=j.toISOString()}}function o(d){c.get("templates/form-templates/spfield-datetime-"+d+".html",{cache:b}).success(function(b){var c=a(b)(h);i.replaceWith(c),i=c})}function p(){var a=_spPageContextInfo.webServerRelativeUrl;return null===a&&(a=""),a.endsWith("/")&&(a=a.substring(0,a.length-1)),a+="/_layouts/15/"}h.schema=k[0].getFieldSchema(j.name),h.$watch(function(){return h.mode||k[0].getFormMode()},function(a){h.currentMode=a,l().then(function(){o(a)})}),h.showDatePicker=function(a){var b=h.idPrefix+"_$DateTimeFieldDate",c=document.getElementById(b+g_strDatePickerFrameID);return null!==c&&(Boolean(c.attachEvent)?c.attachEvent("onreadystatechange",m):Boolean(c.addEventListener)&&(c.Picker=c,c.readyState="complete",c.addEventListener("load",m,!1))),clickDatePicker(b,h.datePickerUrl,h.dateOnlyModel,a.originalEvent),!1},h.$watch("[dateOnlyModel, hoursModel, minutesModel]",n,!0)}}}]),angular.module("ngSharePoint").directive("spfieldDescription",function(){return{restrict:"EA",require:"^spform",replace:!0,templateUrl:"templates/form-templates/spfield-description.html",scope:{mode:"@"},link:function(a,b,c,d){a.schema=d.getFieldSchema(c.name),a.$watch(function(){return a.mode||d.getFormMode()},function(b){a.currentMode=b})}}}),angular.module("ngSharePoint").directive("spfieldLabel",function(){return{restrict:"EA",require:"^spform",replace:!0,templateUrl:"templates/form-templates/spfield-label.html",scope:{mode:"@"},link:function(a,b,c,d){a.schema=d.getFieldSchema(c.name),a.$watch(function(){return a.mode||d.getFormMode()},function(b){a.currentMode=b})}}}),angular.module("ngSharePoint").directive("spfieldLookup",["$compile","$templateCache","$http","$q","$filter","SharePoint",function(a,b,c,d,e,f){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:'<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>',link:function(g,h,i,j){function k(){l('<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>'),n(g.currentMode).then(function(){m(g.currentMode)},function(a){g.errorMsg=a.message,l(void 0===g.value?"":'<span style="color: brown">{{errorMsg}}</span>')})}function l(b){var c=a(b)(g);h.replaceWith(c),h=c}function m(a){c.get("templates/form-templates/spfield-lookup-"+a+".html",{cache:b}).success(function(a){l(a)})}function n(a){return"edit"===a?q():p()}function o(){var a=d.defer();return void 0===g.lookupList?f.getWeb(g.schema.LookupWebId).then(function(b){b.getList(g.schema.LookupList).then(function(b){g.lookupList=b,b.getProperties({$expand:"Forms"}).then(function(){b.getFields().then(function(){a.resolve(g.lookupList)},function(b){a.reject(b)})},function(b){a.reject(b)})},function(b){a.reject(b)})}):a.resolve(g.lookupList),a.promise}function p(){var a=d.defer();return void 0!==g.lookupItem?a.resolve(g.lookupItem):o().then(function(b){null===g.value||0===g.value||void 0===g.value?(g.lookupItem={Title:"",url:""},a.resolve(g.lookupItem)):b.getItemById(g.value).then(function(b){var c=b[g.schema.LookupField],d=g.lookupList.Fields[g.schema.LookupField];if("DateTime"===d.TypeAsString&&null!==c){var f=__cultureInfo||Sys.CultureInfo.CurrentCulture,h=new Date(c);c=e("date")(h,f.dateTimeFormat.ShortDatePattern+(0===d.DisplayFormat?"":" "+f.dateTimeFormat.ShortTimePattern))}"Number"===d.TypeAsString&&d.Percentage&&(c+="%"),"Computed"===d.TypeAsString&&null!==c&&(c=b.Title),g.lookupItem={Title:c,url:b.list.Forms.results[0].ServerRelativeUrl+"?ID="+g.value+"&Source="+encodeURIComponent(window.location)},a.resolve(g.lookupItem)},function(b){a.reject(b)})},function(b){a.reject(b)}),a.promise}function q(){var a=d.defer();return void 0!==g.lookupItems?a.resolve(g.lookupItems):o().then(function(b){var c=void 0;void 0!==g.dependency&&(c={$select:"*, "+g.dependency.fieldName+"/Id",$expand:g.dependency.fieldName+"/Id",$filter:g.dependency.fieldName+"/Id eq "+g.dependency.value}),b.getListItems(c).then(function(b){if(g.lookupItems=b,g.schema.Required||(g.lookupItems=[{Id:0,Title:STSHtmlEncode(Strings.STS.L_LookupFieldNoneOption)}].concat(b)),(null===g.value||void 0===g.value)&&(g.value=g.schema.Required?g.lookupItems.length>0?g.lookupItems[0].Id:null:0),void 0!==g.dependency){var c=g.lookupItems.reduce(function(a,b){return g.value===b.Id||a},!1);c||(g.value=g.lookupItems.length>0?g.lookupItems[0].Id:null)}g.valueChanged(),a.resolve(g.lookupItems)},function(b){a.reject(b)})},function(b){a.reject(b)}),a.promise}g.schema=j[0].getFieldSchema(i.name),g.$watch(function(){return g.mode||j[0].getFormMode()},function(a){g.currentMode!==a&&(g.currentMode=a,k())}),g.$watch("value",function(a,b){a!==b&&(g.lookupItem=void 0,k())}),void 0!==i.dependsOn&&g.$on(i.dependsOn+"_changed",function(a,b){g.dependency={fieldName:i.dependsOn,value:b},g.lookupItems=void 0,k()}),g.valueChanged=function(){g.lastValue!==g.value&&(j[0].fieldValueChanged(g.schema.InternalName,g.value),g.lastValue=g.value)}}}}]),angular.module("ngSharePoint").directive("spfieldLookupmulti",["$compile","$templateCache","$http","$q","$filter","SharePoint",function(a,b,c,d,e,f){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:'<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>',link:function(g,h,i,j){function k(){null===g.value&&(g.value={results:[]}),l('<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>'),n(g.currentMode).then(function(){m(g.currentMode)},function(a){g.errorMsg=a.message,l(void 0===g.value?"":'<span style="color: brown">{{errorMsg}}</span>')})}function l(b){var c=a(b)(g);h.replaceWith(c),h=c}function m(a){c.get("templates/form-templates/spfield-lookupmulti-"+a+".html",{cache:b}).success(function(a){l(a)})}function n(a){return"edit"===a?r():q()}function o(){var a=d.defer();return void 0===g.lookupList?f.getWeb(g.schema.LookupWebId).then(function(b){b.getList(g.schema.LookupList).then(function(b){g.lookupList=b,b.getProperties({$expand:"Forms"}).then(function(){b.getFields().then(function(){a.resolve(g.lookupList)})})})}):a.resolve(g.lookupList),a.promise}function p(a){var b=d.defer();return void 0!==g.lookupItems?b.resolve(g.lookupItems):o().then(function(c){c.getListItems(a).then(function(a){g.lookupItems=a,b.resolve(g.lookupItems)})}),b.promise}function q(){var a=d.defer();return void 0!==g.selectedLookupItems?a.resolve(g.selectedLookupItems):(g.selectedLookupItems=[],p().then(function(b){null!==g.value&&void 0!==g.value&&angular.forEach(g.value.results,function(a){var c=e("filter")(b,{Id:a},!0)[0];if(void 0!==c){var d=c[g.schema.LookupField],f=g.lookupList.Fields[g.schema.LookupField];if("DateTime"===f.TypeAsString&&null!==d){var h=__cultureInfo||Sys.CultureInfo.CurrentCulture,i=new Date(d);d=e("date")(i,h.dateTimeFormat.ShortDatePattern+(0===f.DisplayFormat?"":" "+h.dateTimeFormat.ShortTimePattern))}"Computed"===f.TypeAsString&&null!==d&&(d=c.Title),g.selectedLookupItems.push({Title:d,url:c.list.Forms.results[0].ServerRelativeUrl+"?ID="+a+"&Source="+encodeURIComponent(window.location)})}}),a.resolve(g.selectedLookupItems)})),a.promise}function r(){var a=d.defer(),b=void 0;return void 0!==g.dependency&&(b={$select:"*, "+g.dependency.fieldName+"/Id",$expand:g.dependency.fieldName+"/Id",$filter:g.dependency.fieldName+"/Id eq "+g.dependency.value}),p(b).then(function(b){g.candidateItems=[],g.selectedCandidateItems=[],g.resultItems=[],g.selectedResultItems=[],angular.forEach(b,function(a){var b=a[g.schema.LookupField],c=g.lookupList.Fields[g.schema.LookupField];if("DateTime"===c.TypeAsString){var d=__cultureInfo||Sys.CultureInfo.CurrentCulture,f=new Date(b);b=e("date")(f,d.dateTimeFormat.ShortDatePattern+(0===c.DisplayFormat?"":" "+d.dateTimeFormat.ShortTimePattern))}var h={id:a.Id,name:b,title:b};g.value&&g.value.results&&-1!=g.value.results.indexOf(a.Id)?g.resultItems.push(h):g.candidateItems.push(h)}),a.resolve()}),a.promise}function s(){(null===g.value||void 0===g.value)&&(g.value={}),g.value.results=[],angular.forEach(g.resultItems,function(a){g.value.results.push(a.id)})}g.schema=j[0].getFieldSchema(i.name),g.idPrefix=g.schema.InternalName+"_"+g.schema.Id,g.addButtonText=STSHtmlEncode(Strings.STS.L_LookupMultiFieldAddButtonText)+" >",g.removeButtonText="< "+STSHtmlEncode(Strings.STS.L_LookupMultiFieldRemoveButtonText),g.candidateAltText=STSHtmlEncode(StBuildParam(Strings.STS.L_LookupMultiFieldCandidateAltText,g.schema.Title)),g.resultAltText=STSHtmlEncode(StBuildParam(Strings.STS.L_LookupMultiFieldResultAltText,g.schema.Title)),g.$watch(function(){return g.mode||j[0].getFormMode()},function(a){g.currentMode!==a&&(g.currentMode=a,k())}),g.$watch("value",function(a,b){a!==b&&(g.selectedLookupItems=void 0,k())}),void 0!==i.dependsOn&&g.$on(i.dependsOn+"_changed",function(a,b){g.dependency={fieldName:i.dependsOn,value:b},g.lookupItems=void 0,g.value=null,k()}),g.addItems=function(){g.resultItems=g.resultItems.concat(g.selectedCandidateItems),g.candidateItems=e("filter")(g.candidateItems,function(a){for(var b=!1,c=0;c<g.selectedCandidateItems.length;c++)if(a.id==g.selectedCandidateItems[c].id){b=!0;break}return!b}),g.selectedCandidateItems=[],s()},g.removeItems=function(){g.candidateItems=g.candidateItems.concat(g.selectedResultItems),g.resultItems=e("filter")(g.resultItems,function(a){for(var b=!1,c=0;c<g.selectedResultItems.length;c++)if(a.id==g.selectedResultItems[c].id){b=!0;break}return!b}),g.selectedResultItems=[],s()}}}}]),angular.module("ngSharePoint").directive("spfieldMultichoice",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-multichoice-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}function i(){var a=[];angular.forEach(d.schema.Choices.results,function(b){-1!=d.choices.indexOf(b)&&a.push(b)}),d.choices=d.value.results=a}d.schema=g[0].getFieldSchema(f.name),null===d.value&&(d.value={results:[]}),d.choices=d.value.results,i(),d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)}),d.toggleCheckbox=function(a){var b=d.choices.indexOf(a);-1!=b?d.choices.splice(b,1):d.choices.push(a),i()}}}}]),angular.module("ngSharePoint").directive("spfieldNote",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-note-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldNumber",["$compile","$templateCache","$http","SPUtils",function(a,b,c,d){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(e,f,g,h){function i(d){c.get("templates/form-templates/spfield-number-"+d+".html",{cache:b}).success(function(b){var c=a(b)(e);f.replaceWith(c),f=c})}var j=h[0].getFieldSchema(g.name),k=d.parseXmlString(j.SchemaXml),l=k.documentElement.getAttribute("Percentage")||"false",m=k.documentElement.getAttribute("Decimals")||"auto";j.Percentage="true"===l.toLowerCase(),j.Decimals=parseInt(m),e.SPClientRequiredValidatorError=Strings.STS.L_SPClientRequiredValidatorError,e.schema=j,e.cultureInfo="undefined"==typeof __cultureInfo?Sys.CultureInfo.CurrentCulture:__cultureInfo,e.$watch(function(){return e.mode||h[0].getFormMode()},function(a){e.currentMode=a,i(a)})}}}]),angular.module("ngSharePoint").directive("spNumber",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$formatters.push(function(b){if(a.schema.Percentage&&void 0!==b){var c=isNaN(a.schema.Decimals)?2:a.schema.Decimals;return(100*b).toFixed(c)}return b}),d.$parsers.push(function(b){if(a.schema.Percentage&&void 0!==b){var c=isNaN(a.schema.Decimals)?2:a.schema.Decimals;return(b/100).toFixed(c)}return b})}}}),angular.module("ngSharePoint").directive("spfieldText",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-text-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.SPClientRequiredValidatorError=Strings.STS.L_SPClientRequiredValidatorError,d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldUrl",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:"<div></div>",link:function(d,e,f,g){function h(f){c.get("templates/form-templates/spfield-url-"+f+".html",{cache:b}).success(function(b){var c=a(b)(d);e.replaceWith(c),e=c})}d.schema=g[0].getFieldSchema(f.name),d.UrlFieldTypeText=Strings.STS.L_UrlFieldTypeText,d.UrlFieldTypeDescription=Strings.STS.L_UrlFieldTypeDescription,d.UrlFieldClickText=Strings.STS.L_UrlFieldClickText,d.Description_Text=Strings.STS.L_Description_Text,d.SPClientRequiredValidatorError=Strings.STS.L_SPClientRequiredValidatorError,d.$watch(function(){return d.mode||g[0].getFormMode()},function(a){d.currentMode=a,h(a)})}}}]),angular.module("ngSharePoint").directive("spfieldUser",["$compile","$templateCache","$http","$q","$timeout","$filter","SharePoint","SPUtils",function(a,b,c,d,e,f,g,h){return{restrict:"EA",require:["^spform","ngModel"],replace:!0,scope:{mode:"@",value:"=ngModel"},template:'<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>',link:function(i,j,k,l){function m(){null!==i.value&&void 0!==i.value||!i.schema.AllowMultipleValues||(i.value={results:[]}),n('<div><img src="/_layouts/15/images/loadingcirclests16.gif" alt="" /></div>'),r().then(function(){o(i.currentMode)
},function(){n('<div style="color: red;">Error al recuperar el usuario {{value}}.</div>')})}function n(b){var c=a(b)(i);j.replaceWith(c),j=c}function o(a){c.get("templates/form-templates/spfield-user-"+a+".html",{cache:b}).success(function(b){if(n(b),"edit"===a){var c=i.idPrefix+"_$ClientPeoplePicker";e(function(){s(c)})}})}function p(){var a=d.defer();return void 0===i.lookupList?g.getWeb().then(function(b){b.getList(i.schema.LookupList).then(function(b){i.lookupList=b,a.resolve(i.lookupList)},function(){a.reject()})},function(){a.reject()}):a.resolve(i.lookupList),a.promise}function q(){var a=d.defer();return void 0!==i.userItems?a.resolve(i.userItems):p().then(function(b){b.getListItems().then(function(b){i.userItems=b,a.resolve(i.userItems)})}),a.promise}function r(){var a=d.defer();return void 0!==i.selectedUserItems?a.resolve(i.selectedUserItems):(i.selectedUserItems=[],q().then(function(b){if(i.schema.AllowMultipleValues)angular.forEach(i.value.results,function(a){var c=f("filter")(b,{Id:a},!0)[0];if(void 0!==c){var d={Title:c[i.schema.LookupField]||c.Title,url:c.list.web.url.rtrim("/")+"/_layouts/15/userdisp.aspx?ID="+i.value+"&Source="+encodeURIComponent(window.location),data:c};i.selectedUserItems.push(d)}});else{var c={Title:"",url:"",data:null};if(null===i.value||0===i.value)i.selectedUserItems.push(c);else{var d=f("filter")(b,{Id:i.value},!0)[0];void 0!==d&&(c={Title:d[i.schema.LookupField]||d.Title,url:d.list.web.url.rtrim("/")+"/_layouts/15/userdisp.aspx?ID="+i.value+"&Source="+encodeURIComponent(window.location),data:d},i.selectedUserItems.push(c))}}a.resolve(i.selectedUserItems)},function(){a.reject()})),a.promise}function s(a){var b={Id:i.schema.Id,Title:i.schema.Title,Hidden:i.schema.Hidden,IMEMode:null,Name:i.schema.InternalName,Required:i.schema.Required,Direction:i.schema.Direction,FieldType:i.schema.TypeAsString,ReadOnlyField:i.schema.ReadOnlyField,Type:"User",DependentLookup:!1,AllowMultipleValues:i.schema.AllowMultipleValues,Presence:i.schema.Presence,WithPicture:!1,DefaultRender:!0,WithPictureDetail:!1,ListFormUrl:"/_layouts/15/listform.aspx",UserDisplayUrl:"/_layouts/15/userdisp.aspx",EntitySeparator:";",PictureOnly:!1,PictureSize:null,UserInfoListId:"{"+i.lookupList.Id+"}",SharePointGroupID:i.schema.SelectionGroup,PrincipalAccountType:"User,DL,SecGroup,SPGroup",SearchPrincipalSource:15,ResolvePrincipalSource:15},c=[];angular.forEach(i.selectedUserItems,function(a){if(null!==a.data){var b=a.data.Title,d=a.data.Name,e={AutoFillDisplayText:b,AutoFillKey:d,AutoFillSubDisplayText:"",Description:b,DisplayText:b,EntityType:"User",IsResolved:!0,Key:d,ProviderDisplayName:"",ProviderName:"",Resolved:!0};c.push(e)}}),this.SPClientPeoplePicker_InitStandaloneControlWrapper(a,c,b);var d=this.SPClientPeoplePicker.SPClientPeoplePickerDict[a+"_TopSpan"];void 0!==d&&null!==d&&(d.OnUserResolvedClientScript=function(a,b){i.schema.AllowMultipleValues===!0?i.value.results=[]:i.value=null,angular.forEach(b,function(a){a.IsResolved&&h.getUserId(a.Key).then(function(a){i.schema.AllowMultipleValues===!0?i.value.results.push(a):i.value=a})}),i.$apply()})}i.schema=l[0].getFieldSchema(k.name),i.noUserPresenceAlt=STSHtmlEncode(Strings.STS.L_UserFieldNoUserPresenceAlt),i.idPrefix=i.schema.InternalName+"_"+i.schema.Id,i.$watch(function(){return i.mode||l[0].getFormMode()},function(a){i.currentMode!==a&&(i.currentMode=a,m())}),i.$watch("value",function(a,b){a!==b&&(null!==i.value&&void 0!==i.value||!i.schema.AllowMultipleValues||(i.value={results:[]}),i.selectedUserItems=void 0,m())}),i.IMNImageOnClick=function(a){return IMNImageOnClick(a.originalEvent),!1},i.GoToLinkOrDialogNewWindow=function(a){return GoToLinkOrDialogNewWindow(a),!1}}}}]),angular.module("ngSharePoint").directive("spfield",["$compile","$templateCache","$http",function(a,b,c){return{restrict:"EA",template:"<tr></tr>",compile:function(){return{pre:function(d,e,f){c.get("templates/form-templates/spfield.html",{cache:b}).success(function(b){var c=f.mode?'mode="'+f.mode+'"':"",g=f.dependsOn?'depends-on="'+f.dependsOn+'"':"";b=b.replace(/\{\{name\}\}/g,f.spfield||f.name).replace(/\{\{mode\}\}/g,c).replace(/\{\{dependsOn\}\}/g,g);var h=a(b)(d);e.replaceWith(h),e=h})}}}}}]),angular.module("ngSharePoint").directive("spformRule",["$compile","$templateCache","$http","$animate",function(a,b,c,d){return{restrict:"E",replace:"element",transclude:!0,priority:50,link:function(e,f,g,h,i){f.parent().length>0&&(g.templateUrl?c.get(g.templateUrl,{cache:b}).success(function(b){var c=a(b)(e);f.replaceWith(c),f=c}):(i(e,function(a){for(var b=a.length-1;b>=0;b--){var c=a[b];d.enter(c,f.parent(),f)}}),f.remove(),f=null))}}}]),angular.module("ngSharePoint").directive("spformToolbar",["$compile","$templateCache","$http","SPUtils",function(a,b,c,d){return{restrict:"EA",require:"^spform",replace:!0,templateUrl:"templates/form-templates/spform-toolbar.html",link:function(a,b,c,e){a.isInDesignMode=d.inDesignMode(),a.status=e.status,d.SharePointReady().then(function(){a.CloseButtonCaption=STSHtmlEncode(Strings.STS.L_CloseButtonCaption),a.SaveButtonCaption=STSHtmlEncode(Strings.STS.L_SaveButtonCaption),a.CancelButtonCaption=STSHtmlEncode(Strings.STS.L_CancelButtonCaption)}),a.$watch(e.getFormMode,function(b){a.mode=b}),a.$watch(e.getFormStatus,function(b){a.formStatus=b}),a.saveForm=function(){e.save()},a.cancelForm=function(){e.cancel()}}}}]),angular.module("ngSharePoint").directive("spform",["SPUtils","$compile","$templateCache","$http","$q",function(a,b,c,d,e){return{restrict:"EA",templateUrl:"templates/form-templates/spform.html",transclude:!0,replace:!0,priority:100,scope:{originalItem:"=item",onPreSave:"&",onPostSave:"&",onCancel:"&"},controller:["$scope","$attrs",function(a,b){this.status={IDLE:0,PROCESSING:1},this.isNew=function(){return a.originalItem.isNew()},this.initField=function(b){if(this.isNew()){var c=this.getFieldSchema(b);switch(c.TypeAsString){case"MultiChoice":a.item[b]={results:[]},null!==c.DefaultValue&&a.item[b].results.push(c.DefaultValue);break;case"DateTime":null!==c.DefaultValue&&(a.item[b]=new Date);break;case"Boolean":null!==c.DefaultValue&&(a.item[b]="1"==c.DefaultValue);break;default:null!==c.DefaultValue&&(a.item[b]=c.DefaultValue)}}},this.getFieldSchema=function(b){if(utils.isGuid(b)){var c=void 0;return angular.forEach(a.schema,function(a){a.Id==b&&(c=a)}),c}return a.schema[b]},this.fieldValueChanged=function(b,c){a.$broadcast(b+"_changed",c)},this.getFormMode=function(){return b.mode||"display"},this.getWebRegionalSettings=function(){var b=e.defer();return void 0!==a.item.list.web.RegionalSettings?b.resolve(a.item.list.web.RegionalSettings):a.item.list.web.getProperties().then(function(){b.resolve(a.item.list.web.RegionalSettings)}),b.promise},this.getFormStatus=function(){return a.formStatus},this.save=function(b){var c=this;a.formStatus=this.status.PROCESSING;var d=SP.UI.ModalDialog.showWaitScreenWithNoClose(SP.Res.dialogLoading15);e.when(a.onPreSave({item:a.item})).then(function(f){f!==!1?a.item.save().then(function(){a.formStatus=this.status.IDLE,e.when(a.onPostSave({originalItem:a.originalItem,item:a.item})).then(function(a){a!==!1&&c.closeForm(b),d.close()},function(){d.close(),a.formStatus=this.status.IDLE})},function(b){console.error(b),d.close();var e=document.createElement("div");e.innerHTML='<div style="color:brown">'+b.code+"<br/><strong>"+b.message+"</strong></div>",SP.UI.ModalDialog.showModalDialog({title:SP.Res.dlgTitleError,html:e,showClose:!0,autoSize:!0,dialogReturnValueCallback:function(){a.formStatus=c.status.IDLE,a.$apply()}})}):(console.log(">>>> Save form was canceled!"),d.close(),a.formStatus=this.status.IDLE)},function(){d.close(),a.formStatus=this.status.IDLE})},this.cancel=function(b){a.item=angular.copy(a.originalItem),a.onCancel({item:a.item})!==!1&&this.closeForm(b)},this.closeForm=function(a){window.location=void 0!==a?a:utils.getQueryStringParamByName("Source")||_spPageContextInfo.webServerRelativeUrl}}],compile:function(e,f,g){return{pre:function(e,f,h,i){function j(a,b,c){var d=!1;e.rulesApplied=[],angular.forEach(b,function(b){if(void 0!==b.tagName&&"spform-rule"==b.tagName.toLowerCase()&&void 0!==b.attributes.test){var f=b.attributes.test.value;if(!d&&e.$eval(f)){a.append(b);var g=!1;void 0!==b.attributes.terminal&&(g=b.attributes.terminal.value,d=e.$eval(g)),e.rulesApplied.push({test:f,terminal:g})}else c&&(b.remove(),b=null)}else a.append(b)})}e.isInDesignMode=a.inDesignMode(),e.isInDesignMode||(e.$watch(function(){return i.getFormMode()},function(a){e.mode=a,void 0!==e.item&&e.item.list.getFields().then(function(a){e.schema=a,e.loadItemTemplate()})}),e.$watch("originalItem",function(a){void 0!==a&&(e.item=angular.copy(a),e.item.clean(),e.item.list.getFields().then(function(a){e.schema=a,e.loadItemTemplate()}))},!0),e.loadItemTemplate=function(){e.formStatus=i.status.PROCESSING;var a=document.querySelector("#form-loading-animation-wrapper-"+e.$id);if(void 0!==a&&angular.element(a).remove(),h.templateUrl)d.get(h.templateUrl,{cache:c}).success(function(a){f.html(""),j(f,angular.element(a),!1),b(f)(e),e.formStatus=i.status.IDLE});else{var k,l=f.find("*"),m="transclude-fields";angular.forEach(l,function(a){void 0!==a.attributes[m]&&(k=angular.element(a))}),void 0===k&&(k=f),k.empty(),g(e,function(a){j(k,a,!0)}),0===k[0].children.length&&(e.fields=[],angular.forEach(e.item.list.Fields,function(a){a.Hidden||a.Sealed||a.ReadOnlyField||"ContentType"===a.InternalName||e.fields.push(a)}),d.get("templates/form-templates/spform-default.html",{cache:c}).success(function(a){k.html("").append(a),b(k)(e),e.formStatus=i.status.IDLE}))}})}}}}}]),angular.module("ngSharePoint").directive("spuser",["SharePoint",function(a){return{restrict:"A",replace:!1,scope:{UserData:"=spuser"},link:function(b,c,d){a.getCurrentWeb().then(function(a){b.currentWeb=a,void 0===c[0].attributes["user-id"]?b.currentWeb.getCurrentUser().then(function(a){b.UserData=a}):b.$watch(function(){return b.$eval(d.userId)},function(a){void 0!==a&&b.currentWeb.getUserById(a).then(function(a){b.UserData=a})})})}}}]),angular.module("ngSharePoint").directive("spworkingonit",function(){return{restrict:"EA",templateUrl:"templates/spworking-on-it.html"}}),angular.module("ngSharePoint").filter("newlines",["$sce",function(a){return function(b){return a.trustAsHtml((b||"").replace(/\n/g,"<br/>"))}}]),angular.module("ngSharePoint").filter("unsafe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),angular.module("ngSharePointFormPage",["ngSharePoint"]),angular.module("ngSharePointFormPage").directive("spformpage",["SharePoint","SPUtils",function(a){return{restrict:"EA",link:function(b){var c=_spPageContextInfo.pageListId,d=utils.getQueryStringParamByName("ID");void 0!==c&&void 0!==d&&a.getWeb().then(function(a){a.getList(c).then(function(a){a.getItemById(d).then(function(a){b.item=a},function(a){console.log("Error item",a)})},function(a){console.log("Error list",a)})},function(a){console.log("Error web",a)}),b.onPreSave=function(a){console.log(">>>> onPreSave",a)},b.onPostSave=function(a){console.log(">>>> onPostSave",a)},b.onCancel=function(a){console.log(">>>> onCancel",a)}}}}]);var element=document.querySelector("[data-spformpage]");element&&angular.bootstrap(element,["ngSharePointFormPage"]),angular.module("ngSharePoint",["ngSharePoint.templates","CamlHelper"]),angular.module("ngSharePoint").constant("SPConfig",{CSOM:!1}),angular.module("ngSharePoint").config(["$compileProvider","SPConfig",function(a){a.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|file|javascript):/)}]),angular.module("ngSharePoint").value("Constants",{errorTemplate:"templates/error.html",userProfileUrl:"_layouts/userdisp.aspx?ID="}),angular.module("ngSharePoint").provider("Config",function(){"use strict";var a=this;a.options={force15LayoutsDirectory:!1,minimalLoadSharePointInfraestructure:!0},a.$get=function(){var b=function(){};return b.options=a.options,b}}),angular.module("ngSharePoint").provider("SharePoint",function(){"use strict";var a=function(a,b,c,d){this.getCurrentWeb=function(){return this.getWeb()},this.getWeb=function(a){var e=b.defer();return c.SharePointReady().then(function(){new d(a).then(function(a){e.resolve(a)})}),e.promise}};this.$get=function(b,c,d,e){return new a(b,c,d,e)}}),angular.module("ngSharePoint").factory("SPCache",["$q","$cacheFactory",function(a,b){"use strict";return{getCache:function(a){var c=b.get(a);return void 0===c&&(c=b(a)),c},getCacheValue:function(a,b){return this.getCache(a).get(b)},setCacheValue:function(a,b,c){this.getCache(a).put(b,c)},removeCacheValue:function(a,b){this.getCache(a).remove(b)}}}]),angular.module("ngSharePoint").factory("SPFolder",["$q",function(a){"use strict";var b=function(a,b,c){if(void 0===a)throw"@web parameter not specified in SPFolder constructor.";if(void 0===b)throw"@path parameter not specified in SPFolder constructor.";this.web=a,this.apiUrl="/GetFolderByServerRelativeUrl('"+b+"')",this.apiUrl=a.apiUrl+this.apiUrl,void 0!==c&&angular.extend(this,c)};return b.prototype.getProperties=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url);return e.executeAsync({url:c.apiUrl+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);angular.extend(c,b),d.resolve(c)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},b.prototype.getFiles=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url);return e.executeAsync({url:c.apiUrl+"/Files"+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a),c=[];angular.forEach(b,function(a){c.push(a)}),d.resolve(c)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},b.prototype.getFolders=function(c){var d=this,e=a.defer(),f="",g=new SP.RequestExecutor(d.web.url);return c?c.$expand=f+(c.$expand?", "+c.$expand:""):c={$expand:f},g.executeAsync({url:d.apiUrl+"/Folders",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var c=utils.parseSPResponse(a),f=[];angular.forEach(c,function(a){f.push(new b(d.web,a.ServerRelativeUrl,a))}),e.resolve(f)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}}),e.promise},b}]),angular.module("ngSharePoint").factory("SPGroup",["$q","SPCache","SPUser",function(a,b,c){"use strict";var d=function(a,b,c){if(void 0===a)throw"@web parameter not specified in SPGroup constructor.";if(void 0===b)throw"@groupName parameter not specified in SPGroup constructor.";this.web=a,this.apiUrl="number"==typeof b?"/sitegroups/GetById('"+b+"')":"/sitegroups/GetByName('"+b+"')",this.apiUrl=a.apiUrl+this.apiUrl,void 0!==c&&angular.extend(this,c)};return d.prototype.getProperties=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url),f="Owner";return b?b.$expand=f+(b.$expand?", "+b.$expand:""):b={$expand:f},e.executeAsync({url:c.apiUrl+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);delete b.Users,angular.extend(c,b),d.resolve(c)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},d.prototype.getUsers=function(){var b=this,d=a.defer();if(void 0!==this.Users)d.resolve(this.Users);else{var e=new SP.RequestExecutor(b.web.url);e.executeAsync({url:b.apiUrl+"/Users",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var e=utils.parseSPResponse(a),f=[];angular.forEach(e,function(a){f.push(new c(b.web,a.Id,a))}),b.Users=f,d.resolve(f)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}})}return d.promise},d}]),angular.module("ngSharePoint").factory("SPList",["$q","SPCache","SPFolder","SPListItem",function(a,b,c,d){"use strict";var e=function(a,c,d){if(void 0===a)throw"@web parameter not specified in SPList constructor.";if(void 0===c)throw"@listName parameter not specified in SPList constructor.";this.web=a,this.listName=c.trim().ltrim("{").rtrim("}"),this.apiUrl=utils.isGuid(this.listName)?"/Lists(guid'"+this.listName+"')":"userinfolist"==this.listName.toLowerCase()?"/SiteUserInfoList":"/Lists/GetByTitle('"+this.listName+"')",this.apiUrl=a.apiUrl+this.apiUrl,this.Fields=b.getCacheValue("SPListFieldsCache",this.apiUrl),void 0!==d&&angular.extend(this,d)};return e.prototype.getListItemEntityTypeFullName=function(){var b=this,c=a.defer();return this.ListItemEntityTypeFullName?c.resolve(this.ListItemEntityTypeFullName):b.getProperties().then(function(){c.resolve(b.ListItemEntityTypeFullName)}),c.promise},e.prototype.getProperties=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url),f="Views";return b?b.$expand=f+(b.$expand?", "+b.$expand:""):b={$expand:f},e.executeAsync({url:c.apiUrl+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);delete b.Fields,angular.extend(c,b),d.resolve(b)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},e.prototype.getRootFolder=function(){var b=this,d=a.defer();if(void 0!==this.RootFolder&&void 0!==this.RootFolder.__deferred&&delete this.RootFolder,void 0!==this.RootFolder)d.resolve(this.RootFolder);else{var e=new SP.RequestExecutor(b.web.url);e.executeAsync({url:b.apiUrl+"/RootFolder",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var e=utils.parseSPResponse(a);this.RootFolder=new c(b.web,e.ServerRelativeUrl,e),d.resolve(this.RootFolder)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}})}return d.promise},e.prototype.getListItems=function(b){var c=this,e=a.defer(),f=new SP.RequestExecutor(c.web.url),g="ContentType, File, File/ParentFolder, Folder, Folder/ParentFolder";return b?b.$expand=g+(b.$expand?", "+b.$expand:""):b={$expand:g},f.executeAsync({url:c.apiUrl+"/Items"+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a),f=[];angular.forEach(b,function(a){var b=new d(c,a);f.push(b)}),e.resolve(f)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}}),e.promise},e.prototype.getItemById=function(b,c){var e=this,f=a.defer(),g=new SP.RequestExecutor(e.web.url),h="ContentType, File, File/ParentFolder, Folder, Folder/ParentFolder",i={$expand:h+(c?", "+c:"")};return g.executeAsync({url:e.apiUrl+"/getItemById("+b+")"+utils.parseQuery(i),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a),c=new d(e,b);f.resolve(c)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});f.reject(d)}}),f.promise},e.prototype.createItem=function(b){var c=this,d=a.defer();return c.getListItemEntityTypeFullName().then(function(a){var e=new SP.RequestExecutor(c.web.url),f={__metadata:{type:a}};angular.extend(f,b);var g={Accept:"application/json; odata=verbose","content-type":"application/json;odata=verbose"},h=document.getElementById("__REQUESTDIGEST");null!==h&&(g["X-RequestDigest"]=h.value),e.executeAsync({url:c.apiUrl+"/items",method:"POST",body:angular.toJson(f),headers:g,success:function(a){var b=utils.parseSPResponse(a);d.resolve(b)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}})}),d.promise},e.prototype.updateItem=function(b,c){var d=this,e=a.defer();return d.getListItemEntityTypeFullName().then(function(a){var f=new SP.RequestExecutor(d.web.url),g={__metadata:{type:a}};angular.extend(g,c);var h={Accept:"application/json; odata=verbose","content-type":"application/json;odata=verbose","X-HTTP-Method":"MERGE","IF-MATCH":"*"},i=document.getElementById("__REQUESTDIGEST");null!==i&&(h["X-RequestDigest"]=i.value),f.executeAsync({url:d.apiUrl+"/items("+b+")",method:"POST",body:angular.toJson(g),headers:h,success:function(a){var b=utils.parseSPResponse(a);e.resolve(b)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}})}),e.promise},e.prototype.deleteItem=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url),f={Accept:"application/json; odata=verbose","X-HTTP-Method":"DELETE","IF-MATCH":"*"},g=document.getElementById("__REQUESTDIGEST");return null!==g&&(f["X-RequestDigest"]=g.value),e.executeAsync({url:c.apiUrl+"/items("+b+")",method:"POST",headers:f,success:function(a){var b=utils.parseSPResponse(a);d.resolve(b)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},e}]),angular.module("ngSharePoint").factory("SPListItem",["$q","SPUtils",function(a,b){"use strict";var c=function(a,b){if(void 0===a)throw"@list parameter not specified in SPListItem constructor.";if(this.list=a,void 0!==b)if("object"==typeof b&&void 0===b.concat)angular.extend(this,b),this.clean();else{if(isNaN(parseInt(b)))throw"Incorrect @data parameter in SPListItem constructor";this.Id=b}};return c.prototype.isNew=function(){return void 0===this.Id},c.prototype.clean=function(){var a=this;return angular.forEach(this,function(b,c){"object"==typeof b&&null!==b&&b.__deferred&&delete a[c]}),this},c.prototype.getAPIUrl=function(){var a=this.list.apiUrl+"/Items";return void 0!==this.Id&&(a+="("+this.Id+")"),a},c.prototype.getProperties=function(){var b=this,c=a.defer(),d=new SP.RequestExecutor(b.list.web.url);return d.executeAsync({url:b.getAPIUrl(),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var d=utils.parseSPResponse(a);if(0===b.list.BaseType)switch(d.FileSystemObjectType){case 0:b.getFile().then(function(){c.resolve(d)});break;case 1:b.getFolder().then(function(){c.resolve(d)});break;default:c.resolve(d)}},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}}),c.promise},c.prototype.getFile=function(){var b=this,c=a.defer(),d=new SP.RequestExecutor(b.list.web.url);return d.executeAsync({url:b.getAPIUrl()+"/File?$expand=ParentFolder",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var d=utils.parseSPResponse(a);angular.extend(b,d),c.resolve(d)},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}}),c.promise},c.prototype.getFolder=function(){var b=this,c=a.defer(),d=new SP.RequestExecutor(b.list.web.url);return d.executeAsync({url:b.getAPIUrl()+"/Folder?$expand=ParentFolder",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var d=utils.parseSPResponse(a);angular.extend(b,d),c.resolve(d)},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}}),c.promise},c.prototype.getAttachments=function(){var b=this,c=a.defer(),d=new SP.RequestExecutor(b.list.web.url);return this.isNew()?(b.AttachmentFiles=[],b.attachments={add:[],remove:[]},c.resolve(b.AttachmentFiles)):d.executeAsync({url:b.getAPIUrl()+"/AttachmentFiles",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var d=utils.parseSPResponse(a);b.AttachmentFiles=d,b.attachments={add:[],remove:[]},c.resolve(d)},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}}),c.promise},c.prototype.addAttachment=function(c){var d=this,e=a.defer(),f=new SP.RequestExecutor(d.list.web.url);return b.getFileBinary(c).then(function(a){f.executeAsync({url:d.getAPIUrl()+"/AttachmentFiles/add(FileName='"+c.name+"')",method:"POST",binaryStringRequestBody:!0,body:a,state:"Update",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);e.resolve(b)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}})}),e.promise},c.prototype.removeAttachment=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.list.web.url),f={Accept:"application/json; odata=verbose","X-HTTP-Method":"DELETE"},g=document.getElementById("__REQUESTDIGEST");return null!==g&&(f["X-RequestDigest"]=g.value),e.executeAsync({url:c.getAPIUrl()+"/AttachmentFiles('"+b+"')",method:"POST",headers:f,success:function(a){var b=utils.parseSPResponse(a);d.resolve(b)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},c.prototype.processAttachments=function(){var b=this,c=a.defer();if(void 0!==this.attachments){var d=[];void 0!==this.attachments.add&&this.attachments.add.length>0&&angular.forEach(this.attachments.add,function(a){d.push(b.addAttachment(a))}),void 0!==this.attachments.remove&&this.attachments.remove.length>0&&angular.forEach(this.attachments.remove,function(a){d.push(b.removeAttachment(a))}),a.all(d).then(function(){b.attachments.add=[],b.attachments.remove=[],c.resolve()})}else c.resolve();return c.promise},c.prototype.save=function(){var b=this,c=a.defer();return b.list.getListItemEntityTypeFullName().then(function(a){var d=new SP.RequestExecutor(b.list.web.url),e={__metadata:{type:a}},f=angular.extend({},b);delete f.list,delete f.apiUrl;for(var g in f)"function"==typeof f[g]&&delete f[g];angular.forEach(b.list.Fields,function(a){("Computed"===a.TypeAsString||a.ReadOnlyField)&&delete f[a.InternalName]}),delete f.attachments,delete f.AttachmentFiles,angular.extend(e,f),console.log(f,angular.toJson(f));var h={Accept:"application/json; odata=verbose","content-type":"application/json;odata=verbose"},i=document.getElementById("__REQUESTDIGEST");null!==i&&(h["X-RequestDigest"]=i.value),b.isNew()||angular.extend(h,{"X-HTTP-Method":"MERGE","IF-MATCH":"*"}),d.executeAsync({url:b.getAPIUrl(),method:"POST",body:angular.toJson(e),headers:h,success:function(a){var d=utils.parseSPResponse(a);angular.extend(b,d),b.processAttachments().then(function(){c.resolve(d)},function(){c.resolve(d)})},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}})}),c.promise},c.prototype.remove=function(){var b=this,c=a.defer(),d=new SP.RequestExecutor(b.list.web.url),e={Accept:"application/json; odata=verbose","X-HTTP-Method":"DELETE","IF-MATCH":"*"},f=document.getElementById("__REQUESTDIGEST");return null!==f&&(e["X-RequestDigest"]=f.value),d.executeAsync({url:b.getAPIUrl(),method:"POST",headers:e,success:function(a){var b=utils.parseSPResponse(a);c.resolve(b)},error:function(a,b,d){var e=utils.parseError({data:a,errorCode:b,errorMessage:d});c.reject(e)}}),c.promise},c}]),angular.module("ngSharePoint").factory("SPUser",["$q",function(a){var b=function(a,b,c){if(void 0===a)throw"@web parameter not specified in SPUser constructor.";if(void 0===b)throw"@userId parameter not specified in SPUser constructor.";this.web=a,"number"==typeof b?this.apiUrl="/SiteUserInfoList/getItemById('"+b+"')":"string"==typeof b&&(this.apiUrl="/siteusers/getByLoginName(@v)?@v='"+b+"'"),this.apiUrl=a.apiUrl+this.apiUrl,void 0!==c&&angular.extend(this,c)};return b.prototype.getProperties=function(b){var c=this,d=a.defer(),e=new SP.RequestExecutor(c.web.url),f="";return b?b.$expand=f+(b.$expand?", "+b.$expand:""):b={$expand:f},e.executeAsync({url:c.apiUrl+utils.parseQuery(b),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);angular.extend(c,b),d.resolve(c)},error:function(a,b,c){var e=utils.parseError({data:a,errorCode:b,errorMessage:c});d.reject(e)}}),d.promise},b}]),angular.module("ngSharePoint").factory("SPUtils",["Config","$q","$http","ODataParserProvider",function(a,b,c,d){"use strict";var e=!1;return{inDesignMode:function(){var a=window.g_disableCheckoutInEditMode,b=document.forms[MSOWebPartPageFormName],c=b.MSOLayout_InDesignMode||b._wikiPageMode;return!!(a||c&&c.value)},SharePointReady:function(){var c=b.defer(),d=this;return e?c.resolve():SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){var f=[];f.push(d.loadScript("SP.RequestExecutor.js","SP.RequestExecutor")),a.options.minimalLoadSharePointInfraestructure||(f.push(d.loadScript("SP.UserProfiles.js","SP.UserProfiles")),f.push(d.loadScript("datepicker.debug.js","clickDatePicker")),f.push(d.loadScript("clienttemplates.js","")),f.push(d.loadScript("clientforms.js","")),f.push(d.loadScript("clientpeoplepicker.js","SPClientPeoplePicker")),f.push(d.loadScript("autofill.js","")),f.push(d.loadScript(_spPageContextInfo.currentLanguage+"/initstrings.js","Strings")),f.push(d.loadScript(_spPageContextInfo.currentLanguage+"/strings.js","Strings")),f.push(d.loadResourceFile("core.resx"))),b.all(f).then(function(){e=!0,c.resolve()},function(a){console.error("Error loading SharePoint script dependences",a),c.reject(a)})}),c.promise},loadResourceFile:function(d){var e,f=b.defer(),g=d.lastIndexOf(".resx"),h=d.substr(0,-1!=g?g:d.length);return e=a.options.force15LayoutsDirectory?"/_layouts/15/ScriptResx.ashx?name="+h+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name):SP.Utilities.Utility.getLayoutsPageUrl("ScriptResx.ashx")+"?name="+h+"&culture="+STSHtmlEncode(Strings.STS.L_CurrentUICulture_Name),c.get(e).success(function(a){window.Resources=window.Resources||{},a=a.replace(/align - right|align-right/g,"align_right"),a=a.replace(/e - mail|e-mail/g,"email"),a=a.replace(/e - Mail|e-Mail/g,"email"),a=a.replace(/tty - TDD|tty-TDD/g,"tty_TDD");try{var b=eval;b(a),window.Res=window.Res||void 0,void 0!==window.Res&&(window.Resources[h]=window.Res)}catch(c){console.error(c)}f.resolve()}),f.promise},loadScript:function(c,d){var e=b.defer();return a.options.force15LayoutsDirectory?SP.SOD.registerSod(c,"/_layouts/15/"+c):SP.SOD.registerSod(c,SP.Utilities.Utility.getLayoutsPageUrl(c)),EnsureScriptFunc(c,d,function(){e.resolve()}),e.promise},generateCamlQuery:function(a,b){var c,e="";if(void 0===a)c=SP.CamlQuery.createAllItemsQuery();else{if("string"==typeof a)e=a;else if("object"==typeof a){var f=d.ODataParser(b);f.parseExpression(a),e=f.getCAMLQuery()}if(e&&(c=new SP.CamlQuery,c.set_viewXml(e)),a.pagingInfo){var g=new SP.ListItemCollectionPosition;g.set_pagingInfo(a.pagingInfo),c.set_listItemCollectionPosition(g)}}return c},parseQuery:function(a){var b="";return angular.forEach(a,function(a,c){b+=(""!==b?"&":"?")+c+"="+a}),b},parseError:function(a){var b={code:a.errorCode,message:a.errorMessage};try{var c=angular.fromJson(data.body);b.code=c.error.code,b.message=c.error.message.value}catch(d){}return console.error(b.message),b},getRegionalSettings:function(){var a=b.defer();return this.SharePointReady().then(function(){var b=new SP.ClientContext.get_current,c=b.get_web(),d=c.get_regionalSettings(),e=d.get_timeZone();b.load(d),b.load(e),b.executeQueryAsync(function(){d.TimeZone=e,a.resolve(d)},function(b,c){a.reject({sender:b,args:c})})}),a.promise},getCurrentUser:function(){var a=b.defer();return this.SharePointReady().then(function(){var b=new SP.ClientContext.get_current,c=b.get_web(),d=c.get_currentUser();b.load(d),b.executeQueryAsync(function(){a.resolve(d)},function(b,c){a.reject({sender:b,args:c})})}),a.promise},getUserId:function(a){var c=b.defer(),d=new SP.ClientContext.get_current,e=d.get_web().ensureUser(a);return d.load(e),d.executeQueryAsync(function(){c.resolve(e.get_id())},function(a,b){c.reject({sender:a,args:b})}),c.promise},getUserRegionalSettings:function(){var a=b.defer();return this.SharePointReady().then(function(){var b=new SP.ClientContext.get_current,c=new SP.UserProfiles.PeopleManager(b),d=c.getMyProperties();b.load(d),b.executeQueryAsync(function(){a.resolve(d)},function(b,c){a.reject({sender:b,args:c})})}),a.promise},parseXmlString:function(a){var b;if(window.DOMParser){var c=new window.DOMParser;b=c.parseFromString(a,"text/xml")}else 0===a.indexOf("<?")&&(a=a.substr(a.indexOf("?>")+2)),b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);return b},getCurrentUserLCID:function(){var a=b.defer(),d=_spPageContextInfo.webServerRelativeUrl.rtrim("/")+"/_layouts/15/regionalsetng.aspx?Type=User";
return c.get(d).success(function(b){var c,d,e=angular.element(b);if(angular.forEach(e,function(a){a.tagName&&"form"===a.tagName.toLowerCase()&&(c=a)}),void 0!==c){var f=c.querySelector("#ctl00_PlaceHolderMain_ctl02_ctl01_DdlwebLCID"),g=f.querySelector("[selected]");d=g.value}a.resolve(d)}),a.promise},getWebById:function(a){var c=b.defer();return this.SharePointReady().then(function(){var b=new SP.ClientContext,d=b.get_site(),e=d.openWebById(a.ltrim("{").rtrim("}"));b.load(e,"ServerRelativeUrl"),b.executeQueryAsync(function(){c.resolve(e)},function(a,b){c.reject({sender:a,args:b})})}),c.promise},getFileBinary:function(a){var c=b.defer(),d=new FileReader;return d.onload=function(a){for(var b=a.target.result,d=new Uint8Array(b),e="",f=0;f<d.length;f++)e+=String.fromCharCode(d[f]);c.resolve(e)},d.onerror=function(a){c.reject(a.target.error)},d.readAsArrayBuffer(a),c.promise}}}]),angular.module("ngSharePoint").factory("SPWeb",["$q","SPUtils","SPList","SPUser",function(a,b,c,d){"use strict";var e=function(a){return this.url=a,this.getApiUrl()};return e.prototype.getApiUrl=function(){var c=this,d=a.defer();return void 0!==this.apiUrl?d.resolve(this):void 0===this.url?(this.url=_spPageContextInfo.webServerRelativeUrl,this.apiUrl=this.url.rtrim("/")+"/_api/web",d.resolve(this)):(this.url=this.url.trim().ltrim("{").rtrim("}"),utils.isGuid(this.url)?b.getWebById(this.url).then(function(a){c.url=a.get_serverRelativeUrl(),c.apiUrl=c.url.rtrim("/")+"/_api/web",d.resolve(c)}):(this.apiUrl=this.url.rtrim("/")+"/_api/web",d.resolve(this))),d.promise},e.prototype.getProperties=function(c){var d=this,e=a.defer(),f="RegionalSettings/TimeZone";return b.SharePointReady().then(function(){var a=new SP.RequestExecutor(d.url);c?c.$expand=f+(c.$expand?", "+c.$expand:""):c={$expand:f},a.executeAsync({url:d.apiUrl+utils.parseQuery(c),method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a);angular.extend(d,b),e.resolve(b)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}})}),e.promise},e.prototype.getLists=function(){var d=this,e=a.defer();return b.SharePointReady().then(function(){var a=new SP.RequestExecutor(d.url);a.executeAsync({url:d.apiUrl+"/Lists",method:"GET",headers:{Accept:"application/json; odata=verbose"},success:function(a){var b=utils.parseSPResponse(a),f=[];angular.forEach(b,function(a){var b=new c(d,a.Id,a);f.push(b)}),e.resolve(f)},error:function(a,b,c){var d=utils.parseError({data:a,errorCode:b,errorMessage:c});e.reject(d)}})}),e.promise},e.prototype.getList=function(b){var d=a.defer();return d.resolve(new c(this,b)),d.promise},e.prototype.getCurrentUser=function(){var b=a.defer(),c=this;return void 0!==this.currentUser?b.resolve(this.currentUser):this.getUserById(_spPageContextInfo.userId).then(function(a){c.currentUser=a,b.resolve(a)}),b.promise},e.prototype.getUserById=function(b){var c=a.defer();return new d(this,b).getProperties().then(function(a){c.resolve(a)}),c.promise},e.staticMethod=function(){},e}]),String.prototype.ltrim=function(a){return this.replace(new RegExp("^"+a),"")},String.prototype.rtrim=function(a){return this.replace(new RegExp(a+"*$"),"")},String.prototype.trimS=function(a){return this.replace(new RegExp("^"+a),"").replace(new RegExp(a+"*$"),"")};var utils={isGuid:function(a){var b=new RegExp("^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$");return b.test(a.trim().ltrim("{").rtrim("}"))},getQueryStringParameter:function(a){var b=window.location.search.split("?");if(b.length>1){b=b[1].split("&");for(var c=0;c<b.length;c++){var d=b[c].split("=");if(d[0]==a)return d[1]}}},getQueryStringParamByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b="[\\?&]"+a+"=([^&#]*)",c=new RegExp(b),d=c.exec(window.location.search);return null!==d?decodeURIComponent(d[1].replace(/\+/g," ")):void 0},parseQuery:function(a){if(void 0===a)return"";var b="";return angular.forEach(a,function(a,c){var d=c+"="+a;"restfunc"===c.toLowerCase()&&(d="$"+a),b+=(""===b?"?":"&")+d}),b},parseError:function(a){var b={data:a.data,code:a.errorCode,message:a.errorMessage};try{var c=a.data.body.rtrim("\x00");if(-1!=a.data.contentType.indexOf("application/json")){var d=angular.fromJson(c).error;b.code=d.code,b.message=d.message.value}else b.message=c}catch(e){}return console.error(b.message,b),b},parseSPResponse:function(a){var b={};return 204!=a.statusCode&&(b=angular.fromJson(a.body||'{ "d": {} }').d,b.results&&(b=b.results)),b},getFunctionParameterNames:function(a){var b=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,c=/([^\s,]+)/g,d=a.toString().replace(b,""),e=d.slice(d.indexOf("(")+1,d.indexOf(")")).match(c);return e||[]}};